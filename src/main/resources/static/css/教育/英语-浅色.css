/*
================================================================================
|                                                                              |
|                  üìö LexiLearn - Word Weavers (Light Theme) üìö                 |
|                                                                              |
================================================================================
*/

:root {
    /* ------------------------- üåà ‰∏ªÈ¢òÂêçÁß∞‰∏éÊ®°Âºè ------------------------- */
    --theme-name: "LexiLearn - Word Weavers";
    --theme-mode: "light";

    /* ------------------------- üé® Ê†∏ÂøÉÈÖçËâ≤ÊñπÊ°à -------------------------- */

    /* Base Palette - LexiLearn Light */
    --ll-bg-main-rgb: 248, 249, 250;      /* #F8F9FA - Very Light Grey (Body BG) */
    --ll-bg-container-rgb: 255, 255, 255; /* #FFFFFF - White (App Container) */
    --ll-bg-sidebar-rgb: 252, 253, 254;   /* #FCFDFE - Slightly Off-White (Sidebar BG) */
    --ll-bg-elevated-rgb: 249, 250, 251;  /* #F9FAFB - Lightest Grey (Inputs, Cards) */
    --ll-bg-subtle-accent-rgb: 239, 246, 255; /* #EFF6FF - Very Light Blue (for hover, etc.) */

    --ll-text-primary-rgb: 31, 41, 55;    /* #1F2937 - Dark Slate Grey (Main Text) */
    --ll-text-secondary-rgb: 75, 85, 99;  /* #4B5563 - Medium Grey (Secondary Text) */
    --ll-text-placeholder-rgb: 156, 163, 175; /* #9CA3AF - Placeholder Text */

    --ll-primary-green-rgb: 16, 185, 129; /* #10B981 - Emerald Green (Primary Actions, Learning) */
    --ll-secondary-blue-rgb: 59, 130, 246;/* #3B82F6 - Bright Blue (Links, Interactive Elements) */

    --ll-border-strong-rgb: 209, 213, 219; /* #D1D4DB - Medium Grey Border */
    --ll-border-light-rgb: 229, 231, 235;  /* #E5E7EB - Light Grey Border */
    --ll-border-interactive-rgb: var(--ll-secondary-blue-rgb);

    /* Status & Feedback */
    --ll-status-online-rgb: var(--ll-primary-green-rgb);
    --ll-status-notification-rgb: 239, 68, 68; /* #EF4444 - Red */
    --ll-highlight-yellow-rgb: 253, 224, 71;/* #FDE047 - Soft Yellow (Highlights) */

    /* Shadows */
    --ll-shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.03);
    --ll-shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.07), 0 1px 2px -1px rgba(0, 0, 0, 0.05);
    --ll-shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.07), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
    --ll-shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -4px rgba(0, 0, 0, 0.05);
    --ll-shadow-focus-ring: 0 0 0 3px rgba(var(--ll-secondary-blue-rgb), 0.3);

    /* ÈÄöÁî® UI ÈÖçËâ≤ (Mapping to LexiLearn specifics) */
    --color-primary: rgb(var(--ll-primary-green-rgb));
    --color-accent: rgb(var(--ll-secondary-blue-rgb));
    --color-background-body: rgb(var(--ll-bg-main-rgb));
    --color-background-container: rgb(var(--ll-bg-container-rgb));
    --color-background-elevated: rgb(var(--ll-bg-elevated-rgb));

    --color-text-primary: rgb(var(--ll-text-primary-rgb));
    --color-text-secondary: rgb(var(--ll-text-secondary-rgb));
    --color-text-placeholder: rgb(var(--ll-text-placeholder-rgb));
    --color-text-on-accent: white; /* Text on primary/accent color backgrounds */
    --color-text-link: rgb(var(--ll-secondary-blue-rgb));

    --color-border-primary: rgb(var(--ll-primary-green-rgb));
    --color-border-secondary: rgb(var(--ll-border-light-rgb));
    --color-border-interactive: rgb(var(--ll-border-interactive-rgb));

    --color-status-online: rgb(var(--ll-status-online-rgb));
    --color-status-notification: rgb(var(--ll-status-notification-rgb));
    --color-shadow-soft: var(--ll-shadow-sm);
    --color-shadow-medium: var(--ll-shadow-md);

    /* Ê∂àÊÅØÊ∞îÊ≥° */
    --color-message-sent-bg: linear-gradient(135deg, rgb(var(--ll-primary-green-rgb)), rgb(var(--ll-primary-green-rgb), 0.85));
    --color-message-sent-text: white;
    --color-message-received-bg: rgb(var(--ll-bg-elevated-rgb));
    --color-message-received-text: rgb(var(--ll-text-primary-rgb));
    --color-message-system-bg: rgb(var(--ll-bg-subtle-accent-rgb));
    --color-message-system-text: rgb(var(--ll-text-secondary-rgb));
    --color-message-system-border: rgb(var(--ll-border-light-rgb));

    /* Character Palettes - LexiLearn */
    /* Professor Lex - Guiding, Clear, Green/Yellow Tones */
    --ll-char-lex-primary-rgb: 16, 185, 129;    /* #10B981 (Emerald Green) */
    --ll-char-lex-secondary-rgb: 167, 243, 208; /* #A7F3D0 (Light Emerald) */
    --ll-char-lex-accent-rgb: 250, 204, 21;     /* #FACC15 (Sun Yellow) - was --ll-highlight-yellow-rgb */
    --ll-char-lex-msg-bg: linear-gradient(135deg, #f0fdf4, #dcfce7);

    /* Dr. Origin - Historical, Scholarly, Blue/Grey Tones */
    --ll-char-origin-primary-rgb: 59, 130, 246; /* #3B82F6 (Bright Blue) */
    --ll-char-origin-secondary-rgb: 147, 197, 253;/* #93C5FD (Sky Blue) */
    --ll-char-origin-accent-rgb: 107, 114, 128; /* #6B7280 (Slate Grey) */
    --ll-char-origin-msg-bg: linear-gradient(135deg, #eff6ff, #dbeafe);

    /* Pattern Penny - Analytical, Bright, Orange/Amber Tones */
    --ll-char-penny-primary-rgb: 245, 158, 11;  /* #F59E0B (Amber) */
    --ll-char-penny-secondary-rgb: 252, 211, 77;/* #FCD34D (Light Amber) */
    --ll-char-penny-accent-rgb: 234, 88, 12;   /* #EA580C (Deep Orange) */
    --ll-char-penny-msg-bg: linear-gradient(135deg, #fffbeb, #fef3c7);

    /* Context Cody - Practical, Engaging, Purple/Pink Tones */
    --ll-char-cody-primary-rgb: 139, 92, 246;   /* #8B5CF6 (Violet) */
    --ll-char-cody-secondary-rgb: 196, 181, 253;/* #C4B5FD (Light Violet) */
    --ll-char-cody-accent-rgb: 236, 72, 153;    /* #EC4899 (Pink) */
    --ll-char-cody-msg-bg: linear-gradient(135deg, #f5f3ff, #ede9fe);

    /* ÂàòÂΩ¨ËÄÅÂ∏à - Scholarly, Wise, Teal/Gold Tones */
    --ll-char-liubin-primary-rgb: 10, 126, 140;   /* #0A7E8C (Deep Teal) */
    --ll-char-liubin-secondary-rgb: 162, 213, 218; /* #A2D5DA (Light Teal) */
    --ll-char-liubin-accent-rgb: 230, 184, 92;    /* #E6B85C (Gold-ish Yellow) */
    --ll-char-liubin-msg-bg: linear-gradient(135deg, #e0f7fa, #b2ebf2); /* Light Cyan gradient */

    /* ------------------------- ‚úíÔ∏è Â≠ó‰ΩìÊéíÁâà -------------------------- */
    --font-family: "Nunito Sans", "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", Arial, sans-serif;
    --font-size-base: 15px;
    --font-size-small: 13px;
    --font-size-large: 18px;
    --line-height-base: 1.65; /* Increased for better readability */

    /* ------------------------- ‚ú® Êï¥‰ΩìÈ£éÊ†ºÂèÇÊï∞ ------------------------ */
    --border-radius-small: 4px;
    --border-radius-medium: 8px; /* Slightly larger for modern feel */
    --border-radius-large: 12px;
    --shadow-elevation-1: var(--ll-shadow-sm);
    --shadow-elevation-2: var(--ll-shadow-md);
    --shadow-elevation-3: var(--ll-shadow-lg);
    --shadow-ornate: var(--ll-shadow-sm); /* Keep it subtle */
    --transition-fast: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-medium: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);

    --scrollbar-track-color: rgba(var(--ll-text-primary-rgb), 0.05);
    --scrollbar-thumb-color: rgba(var(--ll-text-secondary-rgb), 0.3);
    --scrollbar-thumb-hover-color: rgba(var(--ll-secondary-blue-rgb), 0.5);
    --scrollbar-size: 7px;
}


/* ------------------------- üåç ÂÖ®Â±Ä‰∏éÂü∫Á°ÄÊ†∑Âºè ------------------------ */
*,
*::before,
*::after {
    box-sizing: border-box;
}

body {
    font-family: var(--font-family);
    font-size: var(--font-size-base);
    line-height: var(--line-height-base);
    color: var(--color-text-primary);
    background-color: var(--color-background-body);
    /* Subtle pattern for a "digital paper" feel */
    background-image: url("data:image/svg+xml,%3Csvg width='10' height='10' viewBox='0 0 10 10' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='10' height='10' fill='%23F8F9FA'/%3E%3Ccircle cx='1' cy='1' r='0.5' fill='%23E5E7EB'/%3E%3C/svg%3E");
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    overflow-x: hidden;
}

a {
    color: var(--color-text-link);
    text-decoration: none;
    transition: var(--transition-fast);
}
a:hover {
    color: rgb(var(--ll-primary-green-rgb));
    text-decoration: underline;
}

img {
    max-width: 100%;
    display: block;
}

/* Scrollbar Styling */
::-webkit-scrollbar {
    width: var(--scrollbar-size);
    height: var(--scrollbar-size);
}
::-webkit-scrollbar-track {
    background-color: var(--scrollbar-track-color);
    border-radius: var(--border-radius-medium);
}
::-webkit-scrollbar-thumb {
    background-color: var(--scrollbar-thumb-color);
    border-radius: var(--border-radius-medium);
    border: 2px solid transparent;
    background-clip: content-box;
}
::-webkit-scrollbar-thumb:hover {
    background-color: var(--scrollbar-thumb-hover-color);
}


/* ------------------------- üèõÔ∏è È°µÈù¢ÁªìÊûÑ‰∏éÂÆπÂô® ------------------------ */
.app-container {
    display: flex;
    background-color: var(--color-background-container);
    box-shadow: var(--ll-shadow-lg); /* Prominent shadow for the main app */
    overflow: hidden;
    border: 1px solid rgb(var(--ll-border-light-rgb));
    border-radius: var(--border-radius-large); /* Rounded app container */
}

/* ------------------------- üß≠ ‰æßËæπÊ†è .sidebar-nav -------------------- */
.sidebar-nav {
    background-color: rgb(var(--ll-bg-sidebar-rgb));
    border-right: 1px solid var(--color-border-secondary);
    display: flex;
    flex-direction: column;
    position: relative;
    overflow-y: auto;
    /* Subtle top accent, like a notebook spine color */
    border-top: 3px solid rgb(var(--ll-secondary-blue-rgb), 0.7);
}

.search-bar {
    position: relative;
}
.search-bar input[type="text"] {
    border-radius: var(--border-radius-medium);
    border: 1px solid var(--color-border-secondary);
    background-color: var(--color-background-elevated);
    color: var(--color-text-primary);
    font-family: var(--font-family);
    transition: var(--transition-medium);
    box-shadow: var(--ll-shadow-xs);
}
.search-bar input[type="text"]::placeholder {
    color: var(--color-text-placeholder);
}
.search-bar input[type="text"]:focus {
    outline: none;
    border-color: var(--color-border-interactive);
    box-shadow: var(--ll-shadow-focus-ring), var(--ll-shadow-xs);
}
.search-bar::before { /* Search Icon (using SVG for cleaner look) */
    content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%239CA3AF' width='16' height='16'%3E%3Cpath fill-rule='evenodd' d='M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z' clip-rule='evenodd'/%3E%3C/svg%3E");
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    opacity: 0.7;
}

.chat-list {
    list-style: none;
    overflow-y: auto;
    flex-grow: 1;
}
.chat-list-item {
    display: flex;
    align-items: center;
    border-radius: var(--border-radius-medium);
    cursor: pointer;
    transition: background-color var(--transition-fast), border-left-color var(--transition-fast);
    border: 1px solid transparent;
    border-left: 4px solid transparent; /* Placeholder for active character color */
    position: relative;
}
.chat-list-item:hover {
    background-color: rgb(var(--ll-bg-subtle-accent-rgb));
}
.chat-list-item.active {
    background-color: rgba(var(--ll-primary-green-rgb), 0.08);
    /* border-left-color set by character-specific styles */
}
.chat-list-item.active .chat-list-name {
    color: var(--color-primary); /* Green for active name */
    font-weight: 600;
}

.chat-list-avatar {
    border-radius: 50%;
    object-fit: cover;
    background-color: rgb(var(--ll-border-light-rgb));
    border: 2px solid transparent; /* Character accent on active */
    box-shadow: var(--ll-shadow-xs);
}
.chat-list-item.active .chat-list-avatar {
    /* border-color will be character specific */
    box-shadow: 0 0 0 2px white, 0 0 0 4px var(--color-primary); /* Example active avatar highlight */
}

.chat-list-details { flex-grow: 1; overflow: hidden; }
.chat-list-name {
    font-weight: 500; /* Slightly less bold than active */
    font-size: var(--font-size-base);
    color: var(--color-text-primary);
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.chat-list-preview {
    font-size: var(--font-size-small);
    color: var(--color-text-secondary);
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.chat-list-badge {
    background-color: var(--color-status-notification);
    color: white;
    font-size: 11px; font-weight: bold;
    min-width: 20px; text-align: center;
    border-radius: 10px; /* Pill shape */
}


/* ------------------------- üìú ËÅäÂ§©‰∏ªÂå∫ .chat-area -------------------- */
.chat-area {
    flex-grow: 1; display: flex; flex-direction: column;
    background-color: var(--color-background-container); /* White */
    overflow: hidden;
}

.chat-header-main {
    border-bottom: 1px solid var(--color-border-secondary);
    background: white; /* Clean white header */
    display: flex; align-items: center;
    box-shadow: var(--ll-shadow-sm);
    z-index: 10; /* Above messages */
}
.chat-avatar-main {
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid white; /* Character accent border */
    box-shadow: var(--ll-shadow-sm); /* Will be colored by char CSS */
}
.chat-title-main {
    font-size: var(--font-size-large);
    font-weight: 600;
    color: var(--color-text-primary);
}
.chat-status-main {
    font-size: var(--font-size-small);
    color: var(--color-text-secondary);
    display: flex; align-items: center;
}
.chat-status-main::before { /* Online indicator dot */
    content: ''; display: inline-block;
    border-radius: 50%;
    background-color: var(--color-status-online);
    animation: pulse-ll 2s infinite;
    box-shadow: 0 0 0 0 rgba(var(--ll-primary-green-rgb), 0.7);
}
@keyframes pulse-ll {
    0% { box-shadow: 0 0 0 0 rgba(var(--ll-primary-green-rgb), 0.6); }
    70% { box-shadow: 0 0 0 6px rgba(var(--ll-primary-green-rgb), 0); }
    100% { box-shadow: 0 0 0 0 rgba(var(--ll-primary-green-rgb), 0); }
}

.chat-messages {
    flex-grow: 1;
    overflow-y: auto;
    display: flex;
    flex-direction: column-reverse; /* New messages at bottom */
    /* Faint notebook lines creative touch */
    background-image:
            linear-gradient(to bottom, transparent  calc(1.65em - 1px), rgba(var(--ll-secondary-blue-rgb), 0.08) calc(1.65em - 1px), rgba(var(--ll-secondary-blue-rgb), 0.08) 1.65em);
    background-size: 100% 1.65em; /* Matches line-height */
    background-position: 0 0.5em; /* Align lines nicely */
}
.chat-messages > div {
    display: flex; flex-direction: column;
    gap: 12px; /* Spacing between messages */
}


.no-chat-selected {
    flex-grow: 1; display: flex; flex-direction: column;
    align-items: center; justify-content: center; text-align: center;
    color: var(--color-text-secondary);
    background-color: rgb(var(--ll-bg-elevated-rgb)); /* Light grey bg for this area */
}
.no-chat-selected .logo-placeholder { /* Use an SVG for this */
    content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 24 24' fill='none' stroke='%239CA3AF' stroke-width='1' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z'%3E%3C/path%3E%3Cpath d='M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z'%3E%3C/path%3E%3C/svg%3E");
    opacity: 0.6;
    margin-bottom: 16px;
}
.no-chat-selected p {
    font-size: var(--font-size-large);
    font-weight: 500;
}

/* üí¨ Ê∂àÊÅØÊ∞îÊ≥° .message */
.message {
    max-width: 78%;
    border-radius: var(--border-radius-large);
    box-shadow: var(--ll-shadow-sm);
    word-wrap: break-word;
    position: relative;
    line-height: 1.5; /* Slightly tighter for bubbles */
}
.message::before { /* Bubble tail */
    content: ""; position: absolute; bottom: 1px;
    width: 0; height: 0;
    border: 8px solid transparent;
}

.message.sent {
    background: var(--color-message-sent-bg);
    color: var(--color-message-sent-text);
    align-self: flex-end; /* Sent messages to the right */
    border-bottom-right-radius: var(--border-radius-small);
}
.message.sent::before {
    right: -8px; border-left-color: rgb(var(--ll-primary-green-rgb), 0.85); /* Match bubble end color */
    border-right-width: 0; border-bottom-width: 0;
    transform: translateY(-3px) scaleX(0.9);
}

.message.received {
    background-color: var(--color-message-received-bg);
    color: var(--color-message-received-text);
    align-self: flex-start; /* Received messages to the left */
    border-bottom-left-radius: var(--border-radius-small);
    border: 1px solid var(--color-border-secondary);
    /* Character-specific left border will be added here */
}
.message.received::before {
    left: -8px; border-right-color: var(--color-message-received-bg);
    border-left-width: 0; border-bottom-width: 0;
    transform: translateY(-3px) scaleX(0.9);
    filter: drop-shadow(-1px 0px 0px rgba(var(--ll-border-light-rgb),0.7));
}

.message-sender {
    font-size: var(--font-size-small);
    font-weight: 600;
    color: var(--color-text-secondary); /* Default sender color, char-specific can override */
}
.message-timestamp {
    font-size: 11px;
    color: rgba(var(--ll-text-secondary-rgb), 0.7);
    text-align: right;
}
.message.received .message-timestamp { text-align: left; }

.message.system {
    align-self: center; background-color: var(--color-message-system-bg);
    color: var(--color-message-system-text); font-size: var(--font-size-small);
    border-radius: var(--border-radius-medium);
    border: 1px dashed var(--color-message-system-border);
    max-width: 90%; text-align: center;
    box-shadow: none;
}
.message.system::before { display: none; }


/* ‚å®Ô∏è ËæìÂÖ•Âå∫ .chat-input-container */
.chat-input-container {
    border-top: 1px solid var(--color-border-secondary);
    background-color: rgb(var(--ll-bg-sidebar-rgb)); /* Match sidebar for consistency */
    display: flex; /* Align items if textarea is not full height */
    box-shadow: 0 -1px 3px rgba(0,0,0, 0.03);
}
.chat-input-container textarea {
    flex-grow: 1;
    border-radius: var(--border-radius-medium);
    border: 1px solid var(--color-border-secondary);
    background-color: var(--color-background-elevated);
    font-family: var(--font-family); font-size: var(--font-size-base);
    color: var(--color-text-primary);
    resize: none;
    transition: var(--transition-medium);
    box-shadow: var(--ll-shadow-xs);
}
.chat-input-container textarea::placeholder { color: var(--color-text-placeholder); }
.chat-input-container textarea:focus {
    outline: none; border-color: var(--color-border-interactive);
    box-shadow: var(--ll-shadow-focus-ring), var(--ll-shadow-xs);
}

#sendButtonMain {
    border-radius: var(--border-radius-medium);
    background-color: var(--color-primary);
    color: var(--color-text-on-accent);
    border: none;
    cursor: pointer;
    font-family: var(--font-family); font-weight: 600;
    transition: var(--transition-fast);
    box-shadow: var(--ll-shadow-sm);
    display: flex; align-items: center; justify-content: center;
    /* Send icon (SVG) */
}
#sendButtonMain:hover {
    background-color: rgb(var(--ll-primary-green-rgb), 0.85); /* Darken primary */
    box-shadow: var(--ll-shadow-md);
}
#sendButtonMain:active { transform: translateY(1px); box-shadow: var(--ll-shadow-xs); }
#sendButtonMain::after { /* For SVG icon if not directly in HTML */
    display: inline-block;
    line-height: 1;
}


/* ‚ÑπÔ∏è ËØ¶ÊÉÖÈù¢Êùø .details-panel */
.details-panel {
    background-color: rgb(var(--ll-bg-sidebar-rgb));
    border-left: 1px solid var(--color-border-secondary);
    overflow-y: auto;
    color: var(--color-text-secondary);
}
.details-panel .details-header {
    text-align: center;
    border-bottom: 1px solid var(--color-border-secondary);
    background: linear-gradient(to bottom, white, rgb(var(--ll-bg-sidebar-rgb)));
}
.details-panel .details-avatar {
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid white; /* Character color will be the shadow */
    box-shadow: 0 0 0 4px white, 0 0 15px 2px rgba(var(--ll-secondary-blue-rgb),0.3); /* Default shadow, char specific overrides */
}
.details-panel .details-name {
    font-weight: 700; font-size: 1.1em;
    color: var(--color-text-primary);
}
.details-panel .details-title { /* e.g., "Workshop Facilitator" */
    font-size: var(--font-size-small);
    color: var(--color-text-secondary);
    font-style: italic;
}
.details-section { }
.details-section-title {
    font-size: var(--font-size-base); font-weight: 600;
    color: var(--color-text-primary);
    border-bottom: 2px solid rgb(var(--ll-primary-green-rgb), 0.7); /* Green underline like a textbook heading */
    position: relative;
    display: inline-block; /* So border only spans text */
}
.details-info-item { display: flex; font-size: var(--font-size-small); }
.details-info-label {
    font-weight: 600; color: var(--color-text-primary);
    flex-shrink: 0; min-width: 70px; /* Adjust as needed */
}
.details-info-value { color: var(--color-text-secondary); flex-grow: 1; }
.details-about-text {
    font-size: var(--font-size-small);
    color: var(--color-text-secondary);
    white-space: pre-wrap;
    background-color: rgb(var(--ll-bg-elevated-rgb)); /* Light box for about text */
    border-radius: var(--border-radius-medium);
    border: 1px solid var(--color-border-secondary);
}


/* üîò ÊåâÈíÆ .btn (General button styles if needed beyond sendButton) */
.btn {
    display: inline-flex; align-items: center; justify-content: center;
    padding: 8px 16px; /* Adjust */
    font-family: var(--font-family); font-size: var(--font-size-base);
    font-weight: 600; text-align: center; text-decoration: none;
    border-radius: var(--border-radius-medium); cursor: pointer;
    transition: var(--transition-fast);
    border: 1px solid transparent; box-shadow: var(--ll-shadow-sm);
}
.btn:hover { box-shadow: var(--ll-shadow-md); }
.btn:active { transform: translateY(1px); box-shadow: var(--ll-shadow-xs); }

.btn-primary {
    background-color: var(--color-primary); color: var(--color-text-on-accent);
    border-color: var(--color-primary);
}
.btn-primary:hover { background-color: rgb(var(--ll-primary-green-rgb), 0.85); }

.btn-secondary {
    background-color: rgb(var(--ll-bg-elevated-rgb)); color: var(--color-text-primary);
    border-color: var(--color-border-secondary);
}
.btn-secondary:hover { background-color: rgb(var(--ll-border-light-rgb)); }


/* üñºÔ∏è ÂºπÁ™ó .modal-content */
.modal-overlay {
    position: fixed; top: 0; left: 0;
    background-color: rgba(var(--ll-text-primary-rgb), 0.5); /* Darker overlay for focus */
    display: flex; align-items: center; justify-content: center;
    z-index: 1000;
}
.modal-content {
    background-color: var(--color-background-container);
    border-radius: var(--border-radius-large);
    box-shadow: var(--ll-shadow-lg);
    border: 1px solid var(--color-border-secondary);
    position: relative;
}
.modal-header {
    font-weight: 600; font-size: var(--font-size-large);
    color: var(--color-text-primary);
    border-bottom: 1px solid var(--color-border-secondary);
    /* Creative: Header could have a color bar */
    border-top: 4px solid var(--color-primary);
    border-top-left-radius: var(--border-radius-large);
    border-top-right-radius: var(--border-radius-large);
}
.modal-body { }
.modal-footer {
    display: flex; justify-content: flex-end;
    gap: 10px; border-top: 1px solid var(--color-border-secondary);
}
.modal-close-button {
    position: absolute; top: 12px; right: 12px;
    background: none; border: none;
    color: var(--color-text-secondary); cursor: pointer;
    border-radius: 50%; width: 32px; height: 32px;
    display: flex; align-items: center; justify-content: center;
    transition: background-color var(--transition-fast), color var(--transition-fast);
}
.modal-close-button:hover {
    background-color: rgb(var(--ll-bg-subtle-accent-rgb));
    color: var(--color-primary);
}
.modal-close-button::after {
    content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='currentColor' width='20' height='20'%3E%3Cpath d='M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z'/%3E%3C/svg%3E");
}

/* ------------------------- üë§ Character Specific Styles -------------------------- */

/* Helper function:
   For each character (Lex, Origin, Penny, Cody, LiuBin):
   - Active chat list item: border-left-color, avatar border, name color
   - Chat header avatar: border-color, title color (optional)
   - Received message: border-left-color, sender name color, special background
   - Details panel avatar: box-shadow color, name color
*/

/* üë®‚Äçüè´ ÂàòÂΩ¨ËÄÅÂ∏à (Liu Bin) */
.chat-list-item.active.AI_LiuBin_CiHuiDaShi { border-left-color: rgb(var(--ll-char-liubin-primary-rgb)); }
.chat-list-item.active.AI_LiuBin_CiHuiDaShi .chat-list-name { color: rgb(var(--ll-char-liubin-primary-rgb)); }
.chat-list-item.active.AI_LiuBin_CiHuiDaShi .chat-list-avatar,
.chat-avatar-main.AI_LiuBin_CiHuiDaShi {
    border-color: rgb(var(--ll-char-liubin-primary-rgb));
    box-shadow: 0 0 0 2px white, 0 0 0 4px rgb(var(--ll-char-liubin-primary-rgb));
}
.chat-header-main.current-chat-AI_LiuBin_CiHuiDaShi .chat-title-main { color: rgb(var(--ll-char-liubin-primary-rgb)); }
.message.received[data-sender-id="AI_LiuBin_CiHuiDaShi"] {
    border-left: 4px solid rgb(var(--ll-char-liubin-primary-rgb));
    background: var(--ll-char-liubin-msg-bg);
}
.message.received[data-sender-id="AI_LiuBin_CiHuiDaShi"] .message-sender { color: rgb(var(--ll-char-liubin-primary-rgb)); }
.details-panel.AI_LiuBin_CiHuiDaShi .details-avatar {
    box-shadow: 0 0 0 4px white, 0 0 15px 2px rgba(var(--ll-char-liubin-primary-rgb),0.4);
}
.details-panel.AI_LiuBin_CiHuiDaShi .details-name { color: rgb(var(--ll-char-liubin-primary-rgb)); }
.details-panel.AI_LiuBin_CiHuiDaShi .details-section-title { border-bottom-color: rgb(var(--ll-char-liubin-primary-rgb)); }


/* Ensure input fields and specific text areas like notifications have contrasting text color if global is too light */
#messageInput, .notification-message {
    color: var(--color-text-primary); /* Default is usually fine, but explicit if needed */
}
/* For TTS config form if it appears in a modal or special section */
#ttsConfigFormContainer .tts-config-item label {
    color: var(--color-text-secondary); /* Ensure labels are readable */
}