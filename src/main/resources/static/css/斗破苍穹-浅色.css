/*
    Theme Name: 斗破苍穹 - 炎动青莲 (Light Mode)
    Description: A light theme for a chat application inspired by "Battle Through the Heavens",
                 focusing on Xiao Yan's Green Lotus Core Flame and a mystical, ancient scroll aesthetic.
*/

:root {
    /* 斗破苍穹 - 炎动青莲 主题色板 (浅色) */
    --dq-light-qinglian-flame-rgb: 70, 180, 200;      /* 青莲之焰 (主强调/交互 - Cyan Blue) */
    --dq-light-qinglian-flame: rgb(var(--dq-light-qinglian-flame-rgb));
    --dq-light-qinglian-flame-darker-rgb: 50, 150, 170;/* 深莲之焰 (悬浮/激活) */
    --dq-light-qinglian-flame-darker: rgb(var(--dq-light-qinglian-flame-darker-rgb));

    --dq-light-misty-scroll-bg-rgb: 248, 246, 240;    /* 云雾卷轴 (背景主色 - Off-white parchment) */
    --dq-light-misty-scroll-bg: rgb(var(--dq-light-misty-scroll-bg-rgb));
    --dq-light-ancient-jade-panel-rgb: 253, 250, 242; /* 古玉面板 (次级背景/面板 - Very light jade/parchment) */
    --dq-light-ancient-jade-panel: rgb(var(--dq-light-ancient-jade-panel-rgb));

    --dq-light-luminous-gold-rgb: 220, 170, 50;     /* 辉光之金 (次强调/高光 - Bright Gold) */
    --dq-light-luminous-gold: rgb(var(--dq-light-luminous-gold-rgb));
    --dq-light-crimson-ember-rgb: 210, 90, 60;      /* 赤炎余烬 (点缀/警告/危险 - Crimson Orange) */
    --dq-light-crimson-ember: rgb(var(--dq-light-crimson-ember-rgb));

    --dq-light-soul-orchid-purple-rgb: 130, 110, 180; /* 灵魂兰紫 (药老/神秘点缀 - Soul Orchid Purple) */
    --dq-light-soul-orchid-purple: rgb(var(--dq-light-soul-orchid-purple-rgb));

    --dq-light-text-ink-black-rgb: 60, 55, 50;       /* 墨黑文字 (主要文字 - Dark Ink Brown/Black) */
    --dq-light-text-ink-black: rgb(var(--dq-light-text-ink-black-rgb));
    --dq-light-text-scroll-gray-rgb: 130, 120, 110;  /* 卷轴褐灰 (次要文字 - Soft Brown/Gray) */
    --dq-light-text-scroll-gray: rgb(var(--dq-light-text-scroll-gray-rgb));

    --dq-light-xuan-iron-border-rgb: 200, 190, 175;  /* 玄铁边框 (边框 - Dark Iron Gray/Stone) */
    --dq-light-xuan-iron-border: rgb(var(--dq-light-xuan-iron-border-rgb));

    /* 角色特定颜色 (浅色) - 炎动青莲 */
    /* 萧炎 - 黑金、青莲色、火红色 */
    --dq-xiaoyan-primary-light-rgb: 50, 50, 50; /* 玄铁黑 */
    --dq-xiaoyan-primary-light: rgb(var(--dq-xiaoyan-primary-light-rgb));
    --dq-xiaoyan-secondary-light: rgba(var(--dq-xiaoyan-primary-light-rgb), 0.1);
    --dq-xiaoyan-accent-gold-light: var(--dq-light-luminous-gold); /* 辉光金 (黑金之金) */
    --dq-xiaoyan-accent-cyan-light: var(--dq-light-qinglian-flame); /* 青莲色 */
    --dq-xiaoyan-accent-fire-light: var(--dq-light-crimson-ember); /* 火红色 */

    /* 药老 - 银白、淡紫、灵魂蓝 */
    --dq-yaolao-primary-light-rgb: 250, 252, 255; /* 魂体银白 */
    --dq-yaolao-primary-light: rgb(var(--dq-yaolao-primary-light-rgb));
    --dq-yaolao-secondary-light: rgba(220, 225, 230, 0.25);
    --dq-yaolao-accent-purple-light: var(--dq-light-soul-orchid-purple); /* 淡紫 */
    --dq-yaolao-accent-soulblue-light: rgb(150, 180, 225); /* 灵魂蓝 */

    /* 美杜莎女王 - 妖紫、玫红、暗金 */
    --dq-medusa-primary-light-rgb: 140, 80, 160; /* 女王妖紫 */
    --dq-medusa-primary-light: rgb(var(--dq-medusa-primary-light-rgb));
    --dq-medusa-secondary-light: rgba(var(--dq-medusa-primary-light-rgb), 0.15);
    --dq-medusa-accent-rose-light: rgb(200, 70, 120); /* 妖艳玫红 */
    --dq-medusa-accent-darkgold-light: rgb(180, 140, 40); /* 蛇纹暗金 */

    /* 云韵 - 天蓝、淡金 */
    --dq-yunyun-primary-light-rgb: 130, 190, 210; /* 风韵天蓝 (原天空青蓝) */
    --dq-yunyun-primary-light: rgb(var(--dq-yunyun-primary-light-rgb));
    --dq-yunyun-secondary-light: rgba(var(--dq-yunyun-primary-light-rgb), 0.15);
    --dq-yunyun-accent-gold-light: rgb(225, 190, 100); /* 云岚淡金 */

    /* 纳兰嫣然 - 浅紫、玫红 */
    --dq-nalan-primary-light-rgb: 190, 160, 220; /* 浅空堇紫 */
    --dq-nalan-primary-light: rgb(var(--dq-nalan-primary-light-rgb));
    --dq-nalan-secondary-light: rgba(var(--dq-nalan-primary-light-rgb), 0.15);
    --dq-nalan-accent-rose-light: rgb(220, 100, 130); /* 嫣然玫红 */

    /* 萧薰儿 - 金黄、赤焰 */
    --dq-xuner-primary-light-rgb: 218, 165, 32; /* 帝炎金黄 (原帝炎金) */
    --dq-xuner-primary-light: rgb(var(--dq-xuner-primary-light-rgb));
    --dq-xuner-secondary-light: rgba(var(--dq-xuner-primary-light-rgb), 0.15);
    --dq-xuner-accent-flame-light: var(--dq-light-crimson-ember); /* 古族赤焰 */

    /* 魂殿 - 深紫、黑焰 */
    --dq-soulhall-primary-light-rgb: 100, 70, 130; /* 魂殿深紫 */
    --dq-soulhall-primary-light: rgb(var(--dq-soulhall-primary-light-rgb));
    --dq-soulhall-secondary-light: rgba(var(--dq-soulhall-primary-light-rgb), 0.1);
    --dq-soulhall-accent-blackflame-light-rgb: 70, 60, 80; /* 黑魔之焰 (深灰紫) */
    --dq-soulhall-accent-blackflame-light: rgb(var(--dq-soulhall-accent-blackflame-light-rgb));

    /* 韩枫 - 暗红、灰黑 */
    --dq-hanfeng-primary-light-rgb: 160, 50, 50; /* 背叛暗红 */
    --dq-hanfeng-primary-light: rgb(var(--dq-hanfeng-primary-light-rgb));
    --dq-hanfeng-secondary-light: rgba(var(--dq-hanfeng-primary-light-rgb), 0.15);
    --dq-hanfeng-accent-grayblack-light-rgb: 80, 80, 80; /* 药尘灰黑 */
    --dq-hanfeng-accent-grayblack-light: rgb(var(--dq-hanfeng-accent-grayblack-light-rgb));

    /* 林修崖 - 青灰、铁绿 (炼药师) */
    --dq-linxiuya-primary-light-rgb: 140, 160, 150; /* 风影青灰 */
    --dq-linxiuya-primary-light: rgb(var(--dq-linxiuya-primary-light-rgb));
    --dq-linxiuya-secondary-light: rgba(var(--dq-linxiuya-primary-light-rgb), 0.15);
    --dq-linxiuya-accent-irongreen-light-rgb: 80, 120, 90; /* 古木铁绿 */
    --dq-linxiuya-accent-irongreen-light: rgb(var(--dq-linxiuya-accent-irongreen-light-rgb));

    /* 其他角色 (从原CSS中保留，可按需调整) */
    --btth-xiaoyixian-primary-light: rgb(160, 165, 150); /* 厄难灰绿 */
    --btth-xiaoyixian-secondary-light: rgba(160, 165, 150, 0.15);
    --btth-haibodong-primary-light: rgb(150, 200, 230); /* 冰皇蓝 */
    --btth-haibodong-secondary-light: rgba(150, 200, 230, 0.15);
    --btth-ziyan-primary-light: rgb(190, 130, 220); /* 龙皇晶紫 */
    --btth-ziyan-secondary-light: rgba(190, 130, 220, 0.15);


    /* 覆盖 Chat 原有变量 */
    --primary-color: var(--dq-light-qinglian-flame);
    --primary-color-rgb: var(--dq-light-qinglian-flame-rgb); /* <<< FIXED: Added this definition */
    --primary-color-dark: var(--dq-light-qinglian-flame-darker);
    --secondary-color: var(--dq-light-ancient-jade-panel); /* 应用主背景 */
    --text-color: var(--dq-light-text-ink-black);
    --text-color-light: var(--dq-light-text-scroll-gray);
    --text-color-inverted: var(--dq-light-misty-scroll-bg); /* 青莲色按钮上的文字 */
    --accent-color: var(--dq-light-luminous-gold);
    --danger-color: var(--dq-light-crimson-ember);
    --warning-color: #D4AC0D; /* 暗金警告 - 保留或调整为主题色 */

    --sent-bg-color: rgba(var(--dq-light-qinglian-flame-rgb), 0.1); /* 发送消息 - 淡青莲底 */
    --received-bg-color: rgba(var(--dq-light-misty-scroll-bg-rgb), 0.9); /* 接收消息 - 云雾卷轴 */

    --border-color: rgba(var(--dq-light-xuan-iron-border-rgb), 0.7);
    --hover-bg-color: rgba(var(--dq-light-qinglian-flame-rgb), 0.07);
    --active-bg-color: rgba(var(--dq-light-qinglian-flame-rgb), 0.18);
    --border-radius: 5px; /* 统一圆角 */
    --font-family: "LXGW WenKai TC", "STKaiti", "SimSun", "Noto Serif SC", "Songti SC", serif;
    --box-shadow: 0 2px 5px rgba(var(--dq-light-text-ink-black-rgb),0.1), 0 0 12px rgba(var(--dq-light-qinglian-flame-rgb),0.08) inset;
    --special-contact-color: var(--dq-xiaoyan-primary-light); /* 默认萧炎黑 */
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
    font-family: var(--font-family), serif;
    background-color: var(--dq-light-misty-scroll-bg); /* 最底层背景 */
    color: var(--text-color);
    line-height: 1.6;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    /* 淡雾蓝 + 流光灰渐变 -> 青莲气息 + 古卷质感 */
    background:
            linear-gradient(135deg, rgba(var(--dq-light-misty-scroll-bg-rgb),0.95), rgba(var(--dq-light-ancient-jade-panel-rgb),0.85)),
            radial-gradient(ellipse at top left, rgba(var(--dq-light-qinglian-flame-rgb),0.15) 0%, transparent 60%),
            radial-gradient(ellipse at bottom right, rgba(var(--dq-light-luminous-gold-rgb),0.1) 0%, transparent 70%);
    background-blend-mode: normal, soft-light, soft-light;
}

.app-container {
    display: flex;
    /* 玄冰石壁或斗技台金纹 -> 古玉面板，增加铭文感边框 */
    background-color: var(--secondary-color);
    border-radius: var(--border-radius);
    border: 1px solid rgba(var(--dq-light-xuan-iron-border-rgb), 0.6);
    box-shadow: 0 5px 25px rgba(var(--dq-light-text-ink-black-rgb),0.15),
    0 0 0 3px rgba(var(--dq-light-luminous-gold-rgb), 0.2); /* 金纹微光 */
    overflow: hidden;
}

/* --- 滚动条美化 (魂殿密纹风格) --- */
::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-track {
    background: rgba(var(--dq-light-ancient-jade-panel-rgb), 0.5);
    border-radius: var(--border-radius);
    border: 1px solid rgba(var(--dq-light-xuan-iron-border-rgb), 0.2);
}
::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, var(--dq-light-qinglian-flame), var(--dq-light-soul-orchid-purple));
    border-radius: var(--border-radius);
    border: 1px solid rgba(var(--dq-light-text-ink-black-rgb), 0.1);
}
::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(135deg, var(--dq-light-qinglian-flame-darker), rgba(var(--dq-light-soul-orchid-purple-rgb),0.7));
}

/* --- Sidebar Navigation (玄岩黑或云雾白) --- */
.sidebar-nav {
    background-color: rgba(var(--dq-light-ancient-jade-panel-rgb), 0.8); /* 云雾白感 */
    border-right: 1px solid var(--border-color);
    position: relative;
    box-shadow: 1px 0 5px rgba(var(--dq-light-text-ink-black-rgb), 0.05);
}
.sidebar-header {
    background-color: rgba(var(--dq-light-misty-scroll-bg-rgb), 0.7);
    border-bottom: 1px solid var(--border-color);
}
.menu-btn { color: var(--text-color-light); }
.menu-btn:hover { color: var(--primary-color); }

/* 搜索框添加炼药符印图案 (意境) */
.search-bar {
    background-color: rgba(var(--dq-light-misty-scroll-bg-rgb), 0.9);
    border: 1px solid var(--border-color);
    color: var(--text-color);
    border-radius: var(--border-radius);
    padding: 8px 12px 8px 30px; /* Space for pseudo icon */
    position: relative;
}
.search-bar::before { /* 炼药符印/搜索图标意境 */
    content: "丹"; /* 或 '🔍' */
    font-family: 'Times New Roman', serif; /* Or a more stylized font if available */
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-color-light);
    font-size: 0.9em;
    opacity: 0.7;
}
.search-bar::placeholder { color: var(--text-color-light); }
.search-bar:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(var(--dq-light-qinglian-flame-rgb),0.2),
    0 0 5px rgba(var(--dq-light-luminous-gold-rgb),0.1) inset;
}
.search-bar:focus::before {
    color: var(--primary-color);
}

.nav-tabs { border-bottom: 1px solid var(--border-color); }
.nav-tab { color: var(--text-color-light); }
.nav-tab:hover { color: var(--primary-color); }
.nav-tab.active {
    color: var(--primary-color);
    border-bottom: 2px solid var(--primary-color);
    font-weight: 600;
    background-image: linear-gradient(to top, rgba(var(--dq-light-qinglian-flame-rgb), 0.05), transparent);
}

/* 火焰悬浮高亮效果 */
.chat-list-item {
    border-bottom: 1px solid var(--border-color);
    transition: background-color 0.2s ease, box-shadow 0.2s ease;
}
.chat-list-item:hover {
    background-color: var(--hover-bg-color);
    box-shadow: inset 3px 0 0 0 var(--dq-light-luminous-gold); /* 金色火焰高光 */
}
.chat-list-item.active {
    background-color: var(--active-bg-color);
    box-shadow: inset 3px 0 0 0 var(--primary-color), /* 青莲主色 */
    0 0 10px rgba(var(--dq-light-qinglian-flame-rgb), 0.15) inset; /* 内部辉光 */
}
.chat-list-item.active .chat-list-name { color: var(--primary-color-dark); font-weight: bold; }

/* 角色气息环绕风格 */
.chat-list-avatar {
    background-color: var(--dq-light-xuan-iron-border);
    font-family: "LXGW WenKai TC", serif;
    border: 2px solid transparent; /* Base for aura */
    color: var(--dq-light-text-ink-black);
    box-shadow: 0 0 3px rgba(var(--dq-light-text-ink-black-rgb), 0.2);
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
}
.chat-list-item:hover .chat-list-avatar {
    border-color: rgba(var(--dq-light-luminous-gold-rgb), 0.5);
    box-shadow: 0 0 5px rgba(var(--dq-light-luminous-gold-rgb), 0.3);
}
.chat-list-item.active .chat-list-avatar {
    border-color: var(--primary-color);
    box-shadow: 0 0 6px rgba(var(--dq-light-qinglian-flame-rgb), 0.4);
}

/* 灵魂力闪烁样式提醒 */
.chat-list-badge {
    background-color: var(--dq-light-crimson-ember);
    color: var(--dq-light-misty-scroll-bg);
    box-shadow: 0 0 6px rgba(var(--dq-light-crimson-ember-rgb), 0.7);
    animation: dq-soul-pulse 1.8s infinite ease-in-out;
    border: 1px solid rgba(var(--dq-light-misty-scroll-bg-rgb),0.5);
}
@keyframes dq-soul-pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.8; }
}

.new-chat-fab {
    background: linear-gradient(135deg, var(--dq-light-qinglian-flame), var(--dq-light-luminous-gold));
    color: var(--dq-light-text-ink-black);
    box-shadow: 0 2px 8px rgba(var(--dq-light-text-ink-black-rgb),0.25),
    0 0 10px rgba(var(--dq-light-qinglian-flame-rgb),0.3),
    0 0 8px rgba(var(--dq-light-luminous-gold-rgb),0.2);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.new-chat-fab:hover {
    background: linear-gradient(135deg, var(--dq-light-qinglian-flame-darker), var(--dq-light-luminous-gold));
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(var(--dq-light-text-ink-black-rgb),0.3),
    0 0 15px rgba(var(--dq-light-qinglian-flame-rgb),0.4),
    0 0 12px rgba(var(--dq-light-luminous-gold-rgb),0.3);
}

/* --- Main Chat Area (斗气结界或魂空间感) --- */
.chat-area {
    background-color: var(--secondary-color); /* Already good, perhaps subtle pattern */
    /* Potential: use ::before for a very subtle texture/pattern overlay */
}
/* 顶部加入斗气铭纹线条 */
.chat-header-main {
    background-color: rgba(var(--dq-light-misty-scroll-bg-rgb), 0.5);
    border-bottom: 1px solid var(--border-color);
    position: relative;
}
.chat-header-main::after { /* 斗气铭纹线条 */
    content: '';
    position: absolute;
    bottom: -1px; /* Overlap border */
    left: 50%;
    transform: translateX(-50%);
    width: 30%;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
    opacity: 0.7;
}
.chat-avatar-main {
    border: 2px solid var(--dq-light-xuan-iron-border);
    box-shadow: 0 1px 4px rgba(var(--dq-light-text-ink-black-rgb), 0.15);
}
.chat-title-main {
    font-weight: 600;
    text-shadow: 0 0 8px rgba(var(--dq-light-qinglian-flame-rgb), 0.15);
}
.header-action-btn { color: var(--text-color-light); }
.header-action-btn:hover {
    color: var(--primary-color);
    text-shadow: 0 0 5px rgba(var(--dq-light-qinglian-flame-rgb), 0.5);
}

.chat-messages-container { padding: 15px; }

/* Placeholder: 🔥、🌌 或“炎”字 Logo -> 用“鼎”字，代表炼药/初始 */
.no-chat-selected .logo-placeholder {
    font-family: "LXGW WenKai TC", serif;
    font-size: 8em;
    font-weight: bold;
    color: rgba(var(--dq-light-qinglian-flame-rgb), 0.25);
    text-shadow: 0 0 10px rgba(var(--dq-light-luminous-gold-rgb),0.2),
    2px 2px 2px rgba(var(--dq-light-xuan-iron-border-rgb),0.5);
    /* For specific character, you can use "炎", "莲", "丹" */
}
.no-chat-selected .logo-placeholder::before {
}
.status-indicator.global {
    background-color: rgba(var(--dq-light-misty-scroll-bg-rgb), 0.6);
    border: 1px solid var(--border-color);
    color: var(--primary-color);
    box-shadow: 0 0 5px rgba(var(--primary-color-rgb),0.2); /* Uses --primary-color-rgb */
}

/* 消息气泡 - 可加一角火焰羽纹 (subtle border effect) */
.message {
    border: 1px solid var(--border-color);
    box-shadow: var(--box-shadow);
    border-radius: var(--border-radius) var(--border-radius) var(--border-radius) var(--border-radius); /* Default */
    position: relative;
    padding: 10px 15px;
}
/* 青莲火、紫焰纹包围 */
.message.sent {
    background-color: var(--sent-bg-color);
    border-left: 3px solid var(--primary-color);
    color: var(--text-color);
    border-radius: var(--border-radius) 0px var(--border-radius) var(--border-radius); /* 羽纹角 */
}
.message.sent::after { /* Subtle flame trail */
    content: '';
    position: absolute;
    top: 0;
    left: -1px;
    bottom: 0;
    width: 5px;
    background: linear-gradient(to bottom, rgba(var(--dq-light-qinglian-flame-rgb),0.3) 0%, rgba(var(--dq-light-luminous-gold-rgb),0.2) 70%, transparent 100%);
    border-radius: 3px 0 0 3px;
    opacity: 0.6;
}
/* 角色专属斗气色 */
.message.received {
    background-color: var(--received-bg-color);
    border-right: 3px solid var(--dq-light-xuan-iron-border); /* Default, overridden by character */
    color: var(--text-color);
    border-radius: 0px var(--border-radius) var(--border-radius) var(--border-radius); /* 羽纹角 */
}
/* 玄符刻纹样式 */
.message.system {
    background-color: rgba(var(--dq-light-ancient-jade-panel-rgb), 0.9);
    color: var(--dq-light-luminous-gold);
    font-style: italic;
    border: 1px dashed var(--dq-light-luminous-gold);
    box-shadow: 0 0 8px rgba(var(--dq-light-luminous-gold-rgb),0.15) inset,
    0 1px 2px rgba(var(--dq-light-text-ink-black-rgb), 0.05);
    text-align: center;
}
.message-sender {
    color: var(--text-color-light);
    font-weight: 600; /* Bolder sender name */
    margin-bottom: 4px;
    display: block;
}
.message .timestamp { color: var(--text-color-light); opacity: 0.75; font-size: 0.8em; }

/* 输入区 - 边框如斗技台金边 */
.chat-input-container {
    background-color: rgba(var(--dq-light-misty-scroll-bg-rgb), 0.6);
    border-top: 1px solid var(--border-color);
    box-shadow: 0 -1px 3px rgba(var(--dq-light-text-ink-black-rgb),0.03);
}
#messageInput {
    background-color: var(--dq-light-ancient-jade-panel);
    border: 1px solid var(--dq-light-xuan-iron-border);
    color: var(--text-color);
    border-radius: var(--border-radius);
    padding: 10px;
    box-shadow: inset 0 1px 3px rgba(var(--dq-light-text-ink-black-rgb),0.05);
}
#messageInput::placeholder { color: var(--text-color-light); }
#messageInput:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(var(--dq-light-qinglian-flame-rgb),0.25),
    inset 0 1px 4px rgba(var(--dq-light-qinglian-flame-rgb),0.1);
}
.icon-btn { color: var(--text-color-light); transition: color 0.2s, background-color 0.2s; }
.icon-btn:hover {
    color: var(--primary-color);
    background-color: rgba(var(--dq-light-qinglian-flame-rgb),0.08);
}
/* 发送按钮为燃烧斗气风格，悬浮时升腾光焰 */
#sendButtonMain {
    color: var(--primary-color);
    font-weight: 600;
    transition: text-shadow 0.2s ease;
}
#sendButtonMain:hover {
    color: var(--primary-color-dark);
    text-shadow: 0 0 6px rgba(var(--dq-light-qinglian-flame-rgb), 0.7),
    0 0 10px rgba(var(--dq-light-luminous-gold-rgb),0.4); /* 升腾光焰 */
}
#voiceButtonMain.recording {
    color: var(--danger-color);
    animation: dq-light-flame-pulse 1.5s infinite;
}
@keyframes dq-light-flame-pulse {
    0% { box-shadow: 0 0 0 0 rgba(var(--dq-light-crimson-ember-rgb), 0.6); }
    70% { box-shadow: 0 0 0 12px rgba(var(--dq-light-crimson-ember-rgb), 0); }
    100% { box-shadow: 0 0 0 0 rgba(var(--dq-light-crimson-ember-rgb), 0); }
}

/* --- Details Panel (玄金或冰蓝) --- */
.details-panel {
    background-color: rgba(var(--dq-light-misty-scroll-bg-rgb), 0.9); /* 玄金意境 */
    border-left: 1px solid var(--border-color);
    box-shadow: -1px 0 5px rgba(var(--dq-light-text-ink-black-rgb), 0.05);
}
.details-header {
    background-color: rgba(var(--dq-light-ancient-jade-panel-rgb), 0.6);
    border-bottom: 1px solid var(--border-color);
}
/* 角色信息展示斗气动态边框 */
.details-avatar {
    border: 3px solid transparent; /* Base for dynamic border */
    box-shadow: 0 0 10px rgba(var(--dq-light-text-ink-black-rgb), 0.1);
    transition: border-color 0.4s ease, box-shadow 0.4s ease;
    /* Default aura */
    border-image: linear-gradient(45deg, var(--dq-light-luminous-gold), var(--dq-light-xuan-iron-border)) 1;
}
.details-panel.character-active .details-avatar { /* Placeholder, actual character class will override */
    animation: dq-douqi-border-glow 3s infinite alternate;
}
@keyframes dq-douqi-border-glow {
    from { border-image: linear-gradient(45deg, var(--dq-light-luminous-gold), var(--primary-color)) 1; box-shadow: 0 0 12px rgba(var(--dq-light-luminous-gold-rgb),0.3); }
    to { border-image: linear-gradient(45deg, var(--primary-color), var(--dq-light-luminous-gold)) 1; box-shadow: 0 0 18px rgba(var(--primary-color-rgb),0.4); } /* Uses --primary-color-rgb */
}

#detailsName {
    text-shadow: 0 1px 2px rgba(var(--dq-light-text-ink-black-rgb), 0.15);
    font-weight: 700;
}
#aiContactDetailsContent {
    background-color: rgba(var(--dq-light-ancient-jade-panel-rgb), 0.5);
    border: 1px solid rgba(var(--dq-light-xuan-iron-border-rgb), 0.3);
    border-radius: var(--border-radius);
    padding: 15px;
    margin: 10px;
}
#aiContactDetailsContent p strong {
    color: var(--primary-color);
    border-bottom: 1px solid rgba(var(--primary-color-rgb), 0.25); /* Uses --primary-color-rgb */
    padding-bottom: 1px;
}
#aiContactBasicInfoList li {
    border-bottom: 1px dotted rgba(var(--dq-light-text-ink-black-rgb), 0.15);
    padding: 8px 0;
}
#aiContactAboutText { color: var(--text-color-light); font-size: 0.9em; line-height: 1.7; }


/* --- 角色特定样式 (浅色 - 炎动青莲) --- */

/* 💎 萧炎 - 黑金、青莲、火红 💎 */
.chat-list-item.special-contact.AI_萧炎_斗破苍穹 .chat-list-avatar,
.chat-avatar-main.AI_萧炎_斗破苍穹, .details-avatar.AI_萧炎_斗破苍穹, #callingModalAvatar.AI_萧炎_斗破苍穹 {
    background-color: var(--dq-xiaoyan-primary-light);
    color: var(--dq-xiaoyan-accent-gold-light);
    border-color: var(--dq-xiaoyan-accent-cyan-light);
    box-shadow: 0 0 6px var(--dq-xiaoyan-accent-cyan-light), 0 0 3px var(--dq-xiaoyan-accent-gold-light) inset;
    text-shadow: 0 0 3px var(--dq-xiaoyan-accent-gold-light);
}
.chat-list-item.active.AI_萧炎_斗破苍穹 {
    background-color: var(--dq-xiaoyan-secondary-light);
    box-shadow: inset 3px 0 0 0 var(--dq-xiaoyan-accent-fire-light),
    0 0 10px rgba(var(--dq-xiaoyan-primary-light-rgb), 0.3) inset;
}
.chat-list-item.active.AI_萧炎_斗破苍穹 .chat-list-name { color: var(--dq-xiaoyan-accent-fire-light); }
.chat-header-main.current-chat-AI_萧炎_斗破苍穹 .chat-title-main {
    color: var(--dq-xiaoyan-primary-light);
    text-shadow: 0 0 3px var(--dq-xiaoyan-accent-cyan-light), 0 0 5px var(--dq-xiaoyan-accent-gold-light);
}
.message.received[data-sender-id="AI_萧炎_斗破苍穹"] {
    border-right-color: var(--dq-xiaoyan-accent-cyan-light);
    background-color: rgba(var(--dq-xiaoyan-primary-light-rgb), 0.03); /* Subtle dark backing */
}
.message.received[data-sender-id="AI_萧炎_斗破苍穹"] .message-sender { color: var(--dq-xiaoyan-accent-fire-light); }
.details-panel.AI_萧炎_斗破苍穹 #detailsName { color: var(--dq-xiaoyan-accent-fire-light); }
.details-panel.AI_萧炎_斗破苍穹 .details-avatar.AI_萧炎_斗破苍穹 {
    border-image: linear-gradient(45deg, var(--dq-xiaoyan-accent-gold-light), var(--dq-xiaoyan-accent-cyan-light), var(--dq-xiaoyan-accent-fire-light)) 1;
    animation-name: dq-xiaoyan-border-glow;
}
@keyframes dq-xiaoyan-border-glow {
    from { border-image: linear-gradient(45deg, var(--dq-xiaoyan-accent-gold-light), var(--dq-xiaoyan-accent-cyan-light)) 1; }
    to { border-image: linear-gradient(45deg, var(--dq-xiaoyan-accent-cyan-light), var(--dq-xiaoyan-accent-fire-light)) 1; }
}
.details-panel.AI_萧炎_斗破苍穹 #aiContactAboutSection h4 span { color: var(--dq-xiaoyan-accent-cyan-light); }


/* 📜 药老 - 银白、淡紫、灵魂蓝 📜 */
.chat-list-item.special-contact.AI_药老_斗破苍穹 .chat-list-avatar,
.chat-avatar-main.AI_药老_斗破苍穹, .details-avatar.AI_药老_斗破苍穹, #callingModalAvatar.AI_药老_斗破苍穹 {
    background-color: var(--dq-yaolao-primary-light);
    color: var(--dq-yaolao-accent-purple-light);
    border-color: var(--dq-yaolao-accent-soulblue-light);
    box-shadow: 0 0 7px var(--dq-yaolao-accent-soulblue-light), 0 0 4px rgba(var(--dq-light-soul-orchid-purple-rgb),0.5) inset; /* Uses defined RGB */
    text-shadow: 0 0 2px var(--dq-yaolao-accent-purple-light);
}
.chat-list-item.active.AI_药老_斗破苍穹 {
    background-color: var(--dq-yaolao-secondary-light);
    box-shadow: inset 3px 0 0 0 var(--dq-yaolao-accent-purple-light),
    0 0 10px rgba(150, 180, 225, 0.2) inset; /* Directly use RGB values for soulblue-light */
}
.chat-list-item.active.AI_药老_斗破苍穹 .chat-list-name { color: var(--dq-yaolao-accent-purple-light); }
.chat-header-main.current-chat-AI_药老_斗破苍穹 .chat-title-main { color: var(--dq-yaolao-accent-soulblue-light); }
.message.received[data-sender-id="AI_药老_斗破苍穹"] {
    border-right-color: var(--dq-yaolao-accent-soulblue-light);
    background-color: rgba(var(--dq-light-soul-orchid-purple-rgb), 0.05); /* Uses defined RGB */
}
.message.received[data-sender-id="AI_药老_斗破苍穹"] .message-sender { color: var(--dq-yaolao-accent-purple-light); }
.details-panel.AI_药老_斗破苍穹 #detailsName { color: var(--dq-yaolao-accent-purple-light); }
.details-panel.AI_药老_斗破苍穹 .details-avatar.AI_药老_斗破苍穹 {
    border-image: linear-gradient(60deg, var(--dq-yaolao-accent-soulblue-light), var(--dq-yaolao-accent-purple-light), var(--dq-light-misty-scroll-bg)) 1;
}
.details-panel.AI_药老_斗破苍穹 #aiContactAboutSection h4 span { color: var(--dq-yaolao-accent-soulblue-light); }


/* 🐍 美杜莎女王 - 妖紫、玫红、暗金 🐍 */
.chat-list-item.special-contact.AI_美杜莎_斗破苍穹 .chat-list-avatar,
.chat-avatar-main.AI_美杜莎_斗破苍穹, .details-avatar.AI_美杜莎_斗破苍穹, #callingModalAvatar.AI_美杜莎_斗破苍穹 {
    background-color: var(--dq-medusa-primary-light);
    color: var(--dq-medusa-accent-darkgold-light);
    border-color: var(--dq-medusa-accent-rose-light);
    text-shadow: 0 0 3px var(--dq-medusa-accent-darkgold-light);
}
.chat-list-item.active.AI_美杜莎_斗破苍穹 {
    background-color: var(--dq-medusa-secondary-light);
    box-shadow: inset 3px 0 0 0 var(--dq-medusa-accent-rose-light),
    0 0 10px rgba(var(--dq-medusa-primary-light-rgb),0.3) inset;
}
.chat-list-item.active.AI_美杜莎_斗破苍穹 .chat-list-name { color: var(--dq-medusa-primary-light); }
.chat-header-main.current-chat-AI_美杜莎_斗破苍穹 .chat-title-main { color: var(--dq-medusa-primary-light); text-shadow: 0 0 4px var(--dq-medusa-accent-rose-light); }
.message.received[data-sender-id="AI_美杜莎_斗破苍穹"] {
    border-right-color: var(--dq-medusa-primary-light);
    background-color: rgba(var(--dq-medusa-primary-light-rgb),0.07);
}
.message.received[data-sender-id="AI_美杜莎_斗破苍穹"] .message-sender { color: var(--dq-medusa-accent-rose-light); }
.details-panel.AI_美杜莎_斗破苍穹 #detailsName { color: var(--dq-medusa-primary-light); }
.details-panel.AI_美杜莎_斗破苍穹 .details-avatar.AI_美杜莎_斗破苍穹 {
    border-image: linear-gradient(45deg, var(--dq-medusa-accent-darkgold-light), var(--dq-medusa-accent-rose-light), var(--dq-medusa-primary-light)) 1;
    animation-name: dq-medusa-border-glow;
}
@keyframes dq-medusa-border-glow {
    from { filter: brightness(1); }
    to { filter: brightness(1.1) saturate(1.2); }
}
.details-panel.AI_美杜莎_斗破苍穹 #aiContactAboutSection h4 span, .details-panel.AI_美杜莎_斗破苍穹 #detailsName { color: var(--dq-medusa-primary-light); }


/* ☁️ 云韵 - 天蓝、淡金 ☁️ */
.chat-list-item.special-contact.AI_云韵_斗破苍穹 .chat-list-avatar,
.chat-avatar-main.AI_云韵_斗破苍穹, .details-avatar.AI_云韵_斗破苍穹, #callingModalAvatar.AI_云韵_斗破苍穹 {
    background-color: var(--dq-yunyun-primary-light);
    color: var(--dq-light-text-ink-black);
    border-color: var(--dq-yunyun-accent-gold-light);
}
.chat-list-item.active.AI_云韵_斗破苍穹 {
    background-color: var(--dq-yunyun-secondary-light);
    box-shadow: inset 3px 0 0 0 var(--dq-yunyun-accent-gold-light),
    0 0 10px rgba(var(--dq-yunyun-primary-light-rgb),0.25) inset;
}
.chat-list-item.active.AI_云韵_斗破苍穹 .chat-list-name { color: var(--dq-yunyun-primary-light); }
.chat-header-main.current-chat-AI_云韵_斗破苍穹 .chat-title-main { color: var(--dq-yunyun-primary-light); text-shadow: 0 0 3px var(--dq-yunyun-accent-gold-light); }
.message.received[data-sender-id="AI_云韵_斗破苍穹"] {
    border-right-color: var(--dq-yunyun-primary-light);
    background-color: rgba(var(--dq-yunyun-primary-light-rgb),0.08);
}
.message.received[data-sender-id="AI_云韵_斗破苍穹"] .message-sender { color: var(--dq-yunyun-primary-light); }
.details-panel.AI_云韵_斗破苍穹 #detailsName { color: var(--dq-yunyun-primary-light); }
.details-panel.AI_云韵_斗破苍穹 .details-avatar.AI_云韵_斗破苍穹 {
    border-image: linear-gradient(45deg, var(--dq-yunyun-accent-gold-light), var(--dq-yunyun-primary-light)) 1;
}
.details-panel.AI_云韵_斗破苍穹 #aiContactAboutSection h4 span { color: var(--dq-yunyun-accent-gold-light); }


/* 🌸 纳兰嫣然 - 浅紫、玫红 🌸 */
.chat-list-item.special-contact.AI_纳兰嫣然_斗破苍穹 .chat-list-avatar,
.chat-avatar-main.AI_纳兰嫣然_斗破苍穹, .details-avatar.AI_纳兰嫣然_斗破苍穹, #callingModalAvatar.AI_纳兰嫣然_斗破苍穹 {
    background-color: var(--dq-nalan-primary-light);
    color: var(--dq-light-text-ink-black);
    border-color: var(--dq-nalan-accent-rose-light);
}
.chat-list-item.active.AI_纳兰嫣然_斗破苍穹 {
    background-color: var(--dq-nalan-secondary-light);
    box-shadow: inset 3px 0 0 0 var(--dq-nalan-accent-rose-light),
    0 0 10px rgba(var(--dq-nalan-primary-light-rgb),0.25) inset;
}
.chat-list-item.active.AI_纳兰嫣然_斗破苍穹 .chat-list-name { color: var(--dq-nalan-primary-light); }
.chat-header-main.current-chat-AI_纳兰嫣然_斗破苍穹 .chat-title-main { color: var(--dq-nalan-primary-light); text-shadow: 0 0 3px var(--dq-nalan-accent-rose-light); }
.message.received[data-sender-id="AI_纳兰嫣然_斗破苍穹"] {
    border-right-color: var(--dq-nalan-primary-light);
    background-color: rgba(var(--dq-nalan-primary-light-rgb),0.08);
}
.message.received[data-sender-id="AI_纳兰嫣然_斗破苍穹"] .message-sender { color: var(--dq-nalan-accent-rose-light); }
.details-panel.AI_纳兰嫣然_斗破苍穹 #detailsName { color: var(--dq-nalan-primary-light); }
.details-panel.AI_纳兰嫣然_斗破苍穹 .details-avatar.AI_纳兰嫣然_斗破苍穹 {
    border-image: linear-gradient(45deg, var(--dq-nalan-accent-rose-light), var(--dq-nalan-primary-light)) 1;
}
.details-panel.AI_纳兰嫣然_斗破苍穹 #aiContactAboutSection h4 span { color: var(--dq-nalan-accent-rose-light); }


/* 🔥 萧薰儿 - 金黄、赤焰 🔥 */
.chat-list-item.special-contact.AI_萧薰儿_斗破苍穹 .chat-list-avatar,
.chat-avatar-main.AI_萧薰儿_斗破苍穹, .details-avatar.AI_萧薰儿_斗破苍穹, #callingModalAvatar.AI_萧薰儿_斗破苍穹 {
    background-color: var(--dq-xuner-primary-light);
    color: var(--dq-light-text-ink-black);
    border-color: var(--dq-xuner-accent-flame-light);
    text-shadow: 0 0 2px var(--dq-light-text-ink-black);
}
.chat-list-item.active.AI_萧薰儿_斗破苍穹 {
    background-color: var(--dq-xuner-secondary-light);
    box-shadow: inset 3px 0 0 0 var(--dq-xuner-accent-flame-light),
    0 0 10px rgba(var(--dq-xuner-primary-light-rgb),0.3) inset;
}
.chat-list-item.active.AI_萧薰儿_斗破苍穹 .chat-list-name { color: var(--dq-xuner-primary-light); }
.chat-header-main.current-chat-AI_萧薰儿_斗破苍穹 .chat-title-main { color: var(--dq-xuner-primary-light); text-shadow: 0 0 4px var(--dq-xuner-accent-flame-light); }
.message.received[data-sender-id="AI_萧薰儿_斗破苍穹"] {
    border-right-color: var(--dq-xuner-primary-light);
    background-color: rgba(var(--dq-xuner-primary-light-rgb),0.07);
}
.message.received[data-sender-id="AI_萧薰儿_斗破苍穹"] .message-sender { color: var(--dq-xuner-accent-flame-light); }
.details-panel.AI_萧薰儿_斗破苍穹 #detailsName { color: var(--dq-xuner-primary-light); }
.details-panel.AI_萧薰儿_斗破苍穹 .details-avatar.AI_萧薰儿_斗破苍穹 {
    border-image: linear-gradient(45deg, var(--dq-xuner-accent-flame-light), var(--dq-xuner-primary-light)) 1;
}
.details-panel.AI_萧薰儿_斗破苍穹 #aiContactAboutSection h4 span { color: var(--dq-xuner-accent-flame-light); }


/* 💀 魂殿 - 深紫、黑焰 💀 */
.chat-list-item.special-contact.AI_魂殿_斗破苍穹 .chat-list-avatar,
.chat-avatar-main.AI_魂殿_斗破苍穹, .details-avatar.AI_魂殿_斗破苍穹, #callingModalAvatar.AI_魂殿_斗破苍穹 {
    background-color: var(--dq-soulhall-primary-light);
    color: var(--dq-light-misty-scroll-bg);
    border-color: var(--dq-soulhall-accent-blackflame-light);
    text-shadow: 0 0 3px var(--dq-light-misty-scroll-bg);
}
.chat-list-item.active.AI_魂殿_斗破苍穹 {
    background-color: var(--dq-soulhall-secondary-light);
    box-shadow: inset 3px 0 0 0 var(--dq-soulhall-accent-blackflame-light),
    0 0 10px rgba(var(--dq-soulhall-primary-light-rgb),0.3) inset;
}
.chat-list-item.active.AI_魂殿_斗破苍穹 .chat-list-name { color: var(--dq-soulhall-primary-light); }
.chat-header-main.current-chat-AI_魂殿_斗破苍穹 .chat-title-main { color: var(--dq-soulhall-primary-light); text-shadow: 0 0 4px var(--dq-soulhall-accent-blackflame-light); }
.message.received[data-sender-id="AI_魂殿_斗破苍穹"] {
    border-right-color: var(--dq-soulhall-primary-light);
    background-color: rgba(var(--dq-soulhall-accent-blackflame-light-rgb),0.1);
}
.message.received[data-sender-id="AI_魂殿_斗破苍穹"] .message-sender { color: var(--dq-soulhall-accent-blackflame-light); }
.details-panel.AI_魂殿_斗破苍穹 #detailsName { color: var(--dq-soulhall-primary-light); }
.details-panel.AI_魂殿_斗破苍穹 .details-avatar.AI_魂殿_斗破苍穹 {
    border-image: linear-gradient(45deg, var(--dq-soulhall-accent-blackflame-light), var(--dq-soulhall-primary-light)) 1;
}
.details-panel.AI_魂殿_斗破苍穹 #aiContactAboutSection h4 span { color: var(--dq-soulhall-accent-blackflame-light); }


/* 🖤 韩枫 - 暗红、灰黑 🖤 */
.chat-list-item.special-contact.AI_韩枫_斗破苍穹 .chat-list-avatar,
.chat-avatar-main.AI_韩枫_斗破苍穹, .details-avatar.AI_韩枫_斗破苍穹, #callingModalAvatar.AI_韩枫_斗破苍穹 {
    background-color: var(--dq-hanfeng-accent-grayblack-light);
    color: var(--dq-hanfeng-primary-light);
    border-color: var(--dq-hanfeng-primary-light);
    text-shadow: 0 0 2px var(--dq-hanfeng-primary-light);
}
.chat-list-item.active.AI_韩枫_斗破苍穹 {
    background-color: var(--dq-hanfeng-secondary-light);
    box-shadow: inset 3px 0 0 0 var(--dq-hanfeng-primary-light),
    0 0 10px rgba(var(--dq-hanfeng-accent-grayblack-light-rgb),0.3) inset;
}
.chat-list-item.active.AI_韩枫_斗破苍穹 .chat-list-name { color: var(--dq-hanfeng-primary-light); }
.chat-header-main.current-chat-AI_韩枫_斗破苍穹 .chat-title-main { color: var(--dq-hanfeng-primary-light); text-shadow: 0 0 3px var(--dq-hanfeng-accent-grayblack-light); }
.message.received[data-sender-id="AI_韩枫_斗破苍穹"] {
    border-right-color: var(--dq-hanfeng-primary-light);
    background-color: rgba(var(--dq-hanfeng-accent-grayblack-light-rgb),0.08);
}
.message.received[data-sender-id="AI_韩枫_斗破苍穹"] .message-sender { color: var(--dq-hanfeng-accent-grayblack-light); }
.details-panel.AI_韩枫_斗破苍穹 #detailsName { color: var(--dq-hanfeng-primary-light); }
.details-panel.AI_韩枫_斗破苍穹 .details-avatar.AI_韩枫_斗破苍穹 {
    border-image: linear-gradient(45deg, var(--dq-hanfeng-primary-light), var(--dq-hanfeng-accent-grayblack-light)) 1;
}
.details-panel.AI_韩枫_斗破苍穹 #aiContactAboutSection h4 span { color: var(--dq-hanfeng-accent-grayblack-light); }


/* 🌿 林修崖 - 青灰、铁绿 🌿 */
.chat-list-item.special-contact.AI_林修崖_斗破苍穹 .chat-list-avatar,
.chat-avatar-main.AI_林修崖_斗破苍穹, .details-avatar.AI_林修崖_斗破苍穹, #callingModalAvatar.AI_林修崖_斗破苍穹 {
    background-color: var(--dq-linxiuya-primary-light);
    color: var(--dq-linxiuya-accent-irongreen-light);
    border-color: var(--dq-linxiuya-accent-irongreen-light);
}
.chat-list-item.active.AI_林修崖_斗破苍穹 {
    background-color: var(--dq-linxiuya-secondary-light);
    box-shadow: inset 3px 0 0 0 var(--dq-linxiuya-accent-irongreen-light),
    0 0 10px rgba(var(--dq-linxiuya-primary-light-rgb),0.2) inset;
}
.chat-list-item.active.AI_林修崖_斗破苍穹 .chat-list-name { color: var(--dq-linxiuya-accent-irongreen-light); }
.chat-header-main.current-chat-AI_林修崖_斗破苍穹 .chat-title-main { color: var(--dq-linxiuya-accent-irongreen-light); }
.message.received[data-sender-id="AI_林修崖_斗破苍穹"] {
    border-right-color: var(--dq-linxiuya-primary-light);
    background-color: rgba(var(--dq-linxiuya-primary-light-rgb),0.08);
}
.message.received[data-sender-id="AI_林修崖_斗破苍穹"] .message-sender { color: var(--dq-linxiuya-primary-light); }
.details-panel.AI_林修崖_斗破苍穹 #detailsName { color: var(--dq-linxiuya-accent-irongreen-light); }
.details-panel.AI_林修崖_斗破苍穹 .details-avatar.AI_林修崖_斗破苍穹 {
    border-image: linear-gradient(45deg, var(--dq-linxiuya-accent-irongreen-light), var(--dq-linxiuya-primary-light)) 1;
}
.details-panel.AI_林修崖_斗破苍穹 #aiContactAboutSection h4 span { color: var(--dq-linxiuya-primary-light); }


/* 保留其他角色 (小医仙, 海波东, 紫妍) - 从原CSS继承，可按需适配新主题 */
/* 小医仙 */
.chat-list-item.special-contact.AI_小医仙_斗破苍穹 .chat-list-avatar,
.chat-avatar-main.AI_小医仙_斗破苍穹, .details-avatar.AI_小医仙_斗破苍穹, #callingModalAvatar.AI_小医仙_斗破苍穹 {
    background-color: var(--btth-xiaoyixian-primary-light); color: var(--dq-light-text-ink-black); border-color: var(--dq-light-text-ink-black);
}
.chat-list-item.active.AI_小医仙_斗破苍穹 { background-color: var(--btth-xiaoyixian-secondary-light); box-shadow: 0 0 8px var(--btth-xiaoyixian-primary-light) inset; }
.chat-list-item.active.AI_小医仙_斗破苍穹 .chat-list-name { color: var(--btth-xiaoyixian-primary-light); }
.chat-header-main.current-chat-AI_小医仙_斗破苍穹 .chat-title-main { color: var(--btth-xiaoyixian-primary-light); }
.message.received[data-sender-id="AI_小医仙_斗破苍穹"] { border-right: 2px solid var(--btth-xiaoyixian-primary-light); background-color: rgba(160, 165, 150, 0.05); }
.message.received[data-sender-id="AI_小医仙_斗破苍穹"] .message-sender { color: var(--btth-xiaoyixian-primary-light); }
.details-panel.AI_小医仙_斗破苍穹 #aiContactAboutSection h4 span, .details-panel.AI_小医仙_斗破苍穹 #detailsName { color: var(--btth-xiaoyixian-primary-light); }

/* 海波东 */
.chat-list-item.special-contact.AI_海波东_斗破苍穹 .chat-list-avatar,
.chat-avatar-main.AI_海波东_斗破苍穹, .details-avatar.AI_海波东_斗破苍穹, #callingModalAvatar.AI_海波东_斗破苍穹 {
    background-color: var(--btth-haibodong-primary-light); color: var(--dq-light-text-ink-black); border-color: var(--dq-light-text-ink-black);
}
.chat-list-item.active.AI_海波东_斗破苍穹 { background-color: var(--btth-haibodong-secondary-light); box-shadow: 0 0 8px var(--btth-haibodong-primary-light) inset; }
.chat-list-item.active.AI_海波东_斗破苍穹 .chat-list-name { color: var(--btth-haibodong-primary-light); }
.chat-header-main.current-chat-AI_海波东_斗破苍穹 .chat-title-main { color: var(--btth-haibodong-primary-light); }
.message.received[data-sender-id="AI_海波东_斗破苍穹"] { border-right: 2px solid var(--btth-haibodong-primary-light); background-color: rgba(150, 200, 230, 0.05); }
.message.received[data-sender-id="AI_海波东_斗破苍穹"] .message-sender { color: var(--btth-haibodong-primary-light); }
.details-panel.AI_海波东_斗破苍穹 #aiContactAboutSection h4 span, .details-panel.AI_海波东_斗破苍穹 #detailsName { color: var(--btth-haibodong-primary-light); }

/* 紫妍 */
.chat-list-item.special-contact.AI_紫妍_斗破苍穹 .chat-list-avatar,
.chat-avatar-main.AI_紫妍_斗破苍穹, .details-avatar.AI_紫妍_斗破苍穹, #callingModalAvatar.AI_紫妍_斗破苍穹 {
    background-color: var(--btth-ziyan-primary-light); color: var(--dq-light-text-ink-black); border-color: var(--dq-light-text-ink-black);
}
.chat-list-item.active.AI_紫妍_斗破苍穹 { background-color: var(--btth-ziyan-secondary-light); box-shadow: 0 0 8px var(--btth-ziyan-primary-light) inset; }
.chat-list-item.active.AI_紫妍_斗破苍穹 .chat-list-name { color: var(--btth-ziyan-primary-light); }
.chat-header-main.current-chat-AI_紫妍_斗破苍穹 .chat-title-main { color: var(--btth-ziyan-primary-light); }
.message.received[data-sender-id="AI_紫妍_斗破苍穹"] { border-right: 2px solid var(--btth-ziyan-primary-light); background-color: rgba(190, 130, 220, 0.05); }
.message.received[data-sender-id="AI_紫妍_斗破苍穹"] .message-sender { color: var(--btth-ziyan-primary-light); }
.details-panel.AI_紫妍_斗破苍穹 #aiContactAboutSection h4 span, .details-panel.AI_紫妍_斗破苍穹 #detailsName { color: var(--btth-ziyan-primary-light); }


/* --- 通用按钮样式 (火纹/魂纹特效) --- */
.btn {
    border-radius: var(--border-radius);
    text-transform: none;
    letter-spacing: 0.5px;
    font-weight: 600; /* Bolder buttons */
    box-shadow: 0 1px 3px rgba(var(--dq-light-text-ink-black-rgb),0.2),
    inset 0 -2px 0px rgba(var(--dq-light-text-ink-black-rgb),0.1); /* Subtle 3D effect */
    border: 1px solid transparent;
    transition: all 0.2s ease-in-out;
    padding: 8px 18px;
    position: relative;
    overflow: hidden;
}
.btn::before { /* For hover/active glow effect */
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: transparent;
    border-radius: var(--border-radius);
    transition: background 0.3s ease;
    z-index: 0;
}
.btn > * { position: relative; z-index: 1; } /* Ensure text is above ::before */

/* 主按钮 - 异火金纹底纹 */
.btn-primary {
    background-color: var(--primary-color);
    color: var(--text-color-inverted);
    border-color: var(--primary-color-dark);
}
.btn-primary:hover {
    background-color: var(--primary-color-dark);
    color: var(--text-color-inverted);
    box-shadow: 0 2px 6px rgba(var(--dq-light-qinglian-flame-rgb),0.3),
    inset 0 -1px 0px rgba(var(--dq-light-text-ink-black-rgb),0.15),
    0 0 10px rgba(var(--dq-light-luminous-gold-rgb),0.2); /* 金纹微光 */
    transform: translateY(-1px);
}
.btn-primary:active::before {
    background: rgba(var(--dq-light-misty-scroll-bg-rgb), 0.15);
}

/* 次按钮 - 魂力闪纹 */
.btn-secondary {
    background-color: var(--dq-light-xuan-iron-border);
    color: var(--dq-light-text-ink-black);
    border-color: rgba(var(--dq-light-text-ink-black-rgb),0.2);
}
.btn-secondary:hover {
    background-color: rgb(190, 180, 160);
    box-shadow: 0 2px 6px rgba(var(--dq-light-xuan-iron-border-rgb),0.3),
    inset 0 -1px 0px rgba(var(--dq-light-text-ink-black-rgb),0.15),
    0 0 8px rgba(var(--dq-light-qinglian-flame-rgb),0.1); /* 魂力闪纹 */
    transform: translateY(-1px);
}
.btn-secondary:active::before {
    background: rgba(var(--dq-light-text-ink-black-rgb), 0.1);
}

.btn-danger {
    background-color: var(--dq-light-crimson-ember);
    color: var(--dq-light-misty-scroll-bg);
    border-color: rgba(180, 50, 50, 0.8);
}
.btn-danger:hover {
    background-color: rgb(180, 50, 50);
    box-shadow: 0 2px 6px rgba(var(--dq-light-crimson-ember-rgb),0.3),
    inset 0 -1px 0px rgba(var(--dq-light-text-ink-black-rgb),0.15);
    transform: translateY(-1px);
}
.btn-success { /* Often similar to primary */
    background-color: var(--primary-color);
    color: var(--text-color-inverted);
    border-color: var(--primary-color-dark);
}
.btn-success:hover {
    background-color: var(--primary-color-dark);
    color: var(--text-color-inverted);
}


/* --- Modals (空间破碎或火焰凝结纹) --- */
.loading-overlay { background-color: rgba(var(--dq-light-misty-scroll-bg-rgb), 0.9); backdrop-filter: blur(3px); }
.loading-spinner {
    width: 60px;
    height: 60px;
    border-width: 5px;
    border-top-color: var(--primary-color);
    border-left-color: var(--primary-color);
    border-bottom-color: rgba(var(--dq-light-qinglian-flame-rgb),0.2);
    border-right-color: rgba(var(--dq-light-qinglian-flame-rgb),0.2);
    animation: spin 1s linear infinite, dq-spinner-color-shift 3s linear infinite alternate;
}
@keyframes dq-spinner-color-shift {
    0% { border-top-color: var(--primary-color); border-left-color: var(--primary-color); }
    50% { border-top-color: var(--dq-light-luminous-gold); border-left-color: var(--dq-light-luminous-gold); }
    100% { border-top-color: var(--dq-light-crimson-ember); border-left-color: var(--dq-light-crimson-ember); }
}

.modal-content {
    background-color: var(--secondary-color);
    border: 1px solid var(--border-color);
    box-shadow: 0 5px 20px rgba(var(--dq-light-text-ink-black-rgb),0.2),
    0 0 0 2px rgba(var(--primary-color-rgb),0.15); /* 火焰凝结纹 - Uses --primary-color-rgb */
    border-radius: var(--border-radius);
}
.modal-header h2 {
    color: var(--primary-color);
    text-shadow: 0 0 5px rgba(var(--primary-color-rgb),0.3), /* Uses --primary-color-rgb */
    0 0 8px rgba(var(--dq-light-luminous-gold-rgb),0.2);
}
.close-modal-btn:hover { color: var(--primary-color); }
.modal-body input[type="text"], .modal-body textarea {
    background-color: rgba(var(--dq-light-misty-scroll-bg-rgb), 0.85);
    color: var(--text-color);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    padding: 10px;
}
.modal-body input[type="text"]:focus, .modal-body textarea:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 1.5px rgba(var(--primary-color-rgb),0.3); /* Uses --primary-color-rgb */
}
.user-id-display #modalUserIdValue {
    background: rgba(var(--dq-light-misty-scroll-bg-rgb),0.8);
    color: var(--primary-color);
    border: 1px dashed var(--primary-color);
    padding: 8px 12px;
    border-radius: var(--border-radius);
    font-weight: 500;
}

/* Video Call */
.video-call-avatar { background-color: var(--dq-light-xuan-iron-border); border: 1px solid var(--border-color); }
.video-call-button.end-call { background: var(--danger-color); }
.video-call-button.active { background: var(--primary-color); color: var(--text-color-inverted); }

/* Toggle Switch */
.slider { background-color: var(--dq-light-xuan-iron-border); }
.slider:before { background-color: var(--dq-light-misty-scroll-bg); box-shadow: 0 1px 2px rgba(0,0,0,0.2); }
input:checked + .slider { background-color: var(--primary-color); }
input:checked + .slider:before { transform: translateX(20px); } /* Adjust based on slider size */


/* --- 确保特定隐藏/显示部分 --- */
#detailsPanelContent #aiContactAboutSection,
#detailsPanelContent #detailsGroupManagement #addGroupMemberArea,
#detailsPanelContent #detailsGroupManagement #leftMembersArea,
#detailsPanelContent #groupActionsDetails,
#detailsPanelContent #dissolveGroupBtnDetails,
#mainMenuModal .settings-section.manual-connection-advanced,
#mainMenuModal #modalResetAllConnectionsBtn {
    display: none;
}

/* 特定于AI角色显示"关于"区域的样式 */
.details-panel.AI_萧炎_斗破苍穹 #aiContactAboutSection,
.details-panel.AI_药老_斗破苍穹 #aiContactAboutSection,
.details-panel.AI_萧薰儿_斗破苍穹 #aiContactAboutSection,
.details-panel.AI_美杜莎_斗破苍穹 #aiContactAboutSection,
.details-panel.AI_小医仙_斗破苍穹 #aiContactAboutSection,
.details-panel.AI_云韵_斗破苍穹 #aiContactAboutSection,
.details-panel.AI_海波东_斗破苍穹 #aiContactAboutSection,
.details-panel.AI_紫妍_斗破苍穹 #aiContactAboutSection,
.details-panel.AI_纳兰嫣然_斗破苍穹 #aiContactAboutSection,
.details-panel.AI_魂殿_斗破苍穹 #aiContactAboutSection,
.details-panel.AI_韩枫_斗破苍穹 #aiContactAboutSection,
.details-panel.AI_林修崖_斗破苍穹 #aiContactAboutSection {
    display: block;
}

.details-panel.human-contact-active #contactActionsDetails { display: block; }
.details-panel.group-chat-active #detailsGroupManagement,
.details-panel.group-chat-active #groupActionsDetails { display: block; }

.notification {
    background: var(--dq-light-ancient-jade-panel);
    border-left: 4px solid var(--primary-color);
    color: var(--text-color);
    box-shadow: 0 2px 8px rgba(var(--dq-light-text-ink-black-rgb),0.15);
    border-radius: var(--border-radius);
    padding: 12px 18px;
}
.notification.error {
    border-left-color: var(--danger-color);
}
.notification.success {
    border-left-color: var(--dq-light-luminous-gold); /* Or a dedicated success green */
}