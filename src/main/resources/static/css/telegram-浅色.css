:root {
    /* Telegram Light Theme Palette */
    --tg-primary-blue-rgb: 0, 136, 204;         /* Telegram ä¸»è“è‰² */
    --tg-primary-blue: rgb(var(--tg-primary-blue-rgb));
    --tg-light-blue-secondary-rgb: 102, 178, 222; /* è¾ƒæµ…çš„è“è‰²ï¼Œç”¨äºå¼ºè°ƒæˆ–èƒŒæ™¯ */
    --tg-light-blue-secondary: rgb(var(--tg-light-blue-secondary-rgb));

    --tg-background-main-rgb: 242, 242, 242;    /* ä¸»åº”ç”¨èƒŒæ™¯ (éå¸¸æµ…çš„ç°) */
    --tg-background-main: rgb(var(--tg-background-main-rgb));
    --tg-background-sidebar-rgb: 247, 247, 247; /* ä¾§è¾¹æ /åˆ—è¡¨èƒŒæ™¯ (æ¯”ä¸»èƒŒæ™¯ç•¥ç™½ä¸€ç‚¹) */
    --tg-background-sidebar: rgb(var(--tg-background-sidebar-rgb));
    --tg-background-chat-rgb: 234, 237, 240;    /* èŠå¤©åŒºåŸŸèƒŒæ™¯ (å¸¦ç»†å¾®çº¹ç†æ„Ÿçš„æµ…ç°) */
    --tg-background-chat: rgb(var(--tg-background-chat-rgb));

    --tg-sent-bubble-rgb: 225, 243, 216;       /* å‘é€æ¶ˆæ¯æ°”æ³¡ (æ·¡ç»¿è‰²) */
    --tg-sent-bubble: rgb(var(--tg-sent-bubble-rgb));
    --tg-received-bubble-rgb: 255, 255, 255;    /* æ¥æ”¶æ¶ˆæ¯æ°”æ³¡ (ç™½è‰²) */
    --tg-received-bubble: rgb(var(--tg-received-bubble-rgb));

    --tg-text-primary-rgb: 33, 33, 33;          /* ä¸»è¦æ–‡å­— (æ·±ç°è‰²) */
    --tg-text-primary: rgb(var(--tg-text-primary-rgb));
    --tg-text-secondary-rgb: 117, 117, 117;     /* æ¬¡è¦æ–‡å­— (ä¸­ç°è‰²) */
    --tg-text-secondary: rgb(var(--tg-text-secondary-rgb));
    --tg-text-white-rgb: 255, 255, 255;
    --tg-text-white: rgb(var(--tg-text-white-rgb));

    --tg-accent-green-rgb: 76, 175, 80;         /* å¼ºè°ƒç»¿ (åœ¨çº¿çŠ¶æ€) */
    --tg-accent-green: rgb(var(--tg-accent-green-rgb));
    --tg-error-red-rgb: 222, 50, 50;            /* é”™è¯¯çº¢ */
    --tg-error-red: rgb(var(--tg-error-red-rgb));
    --tg-warning-orange-rgb: 255, 152, 0;       /* è­¦å‘Šæ©™ */
    --tg-warning-orange: rgb(var(--tg-warning-orange-rgb));

    --tg-border-light-rgb: 224, 224, 224;       /* æµ…è‰²è¾¹æ¡† */
    --tg-border-light: rgb(var(--tg-border-light-rgb));
    --tg-icon-gray-rgb: 158, 158, 158;         /* å›¾æ ‡ç°è‰² */
    --tg-icon-gray: rgb(var(--tg-icon-gray-rgb));

    /* è§’è‰²ç‰¹å®šé¢œè‰² (Telegramé£æ ¼ä¸‹) */
    --tg-ai-contact-primary: var(--tg-primary-blue); /* AIè§’è‰²ä¸»è‰²è°ƒï¼Œä¹Ÿç”¨ä½œé€‰ä¸­èƒŒæ™¯ */
    --tg-ai-contact-secondary: rgba(var(--tg-primary-blue-rgb), 0.1); /* AIåˆ—è¡¨é¡¹çš„æ¬¡çº§èƒŒæ™¯ï¼ˆå¦‚æ‚¬åœï¼‰ï¼Œè¿™é‡Œæœªä½¿ç”¨ */
    --tg-ai-avatar-text: var(--tg-text-white); /* ç”¨äºæ·±è‰²AIå¤´åƒèƒŒæ™¯çš„æ–‡å­— */
    --tg-ai-message-sender: var(--tg-primary-blue); /* AIæ¶ˆæ¯å‘é€è€…åå­—é¢œè‰² */
    --tg-ai-text-on-light-selection-bg: var(--tg-text-primary); /* ç”¨äºAIè§’è‰²åˆ—è¡¨é¡¹é€‰ä¸­æ—¶ï¼ˆå¦‚æœèƒŒæ™¯æ˜¯æµ…è‰²ï¼‰çš„æ–‡å­—é¢œè‰² */


    /* è¦†ç›– P2P Chat åŸæœ‰å˜é‡ */
    --primary-color: var(--tg-primary-blue);
    --primary-color-dark: rgb(0, 119, 179);
    --secondary-color: var(--tg-background-sidebar); /* åº”ç”¨é¢æ¿ä¸»èƒŒæ™¯ */
    --text-color: var(--tg-text-primary);
    --text-color-light: var(--tg-text-secondary);
    --text-color-inverted: var(--tg-text-white);
    --accent-color: var(--tg-accent-green);
    --danger-color: var(--tg-error-red);
    --warning-color: var(--tg-warning-orange);

    --sent-bg-color: var(--tg-sent-bubble);
    --received-bg-color: var(--tg-received-bubble);

    --border-color: var(--tg-border-light);
    --hover-bg-color: rgba(var(--tg-primary-blue-rgb), 0.08); /* è“è‰²ç³»çš„æ‚¬åœ */
    --active-bg-color: var(--primary-color); /* æ™®é€šæ¿€æ´»èƒŒæ™¯ç”¨ä¸»è“è‰² */
    --sidebar-width: 320px;
    --header-height: 56px; /* Telegram å¤´éƒ¨é€šå¸¸è¾ƒçª„ */
    --border-radius: 8px;
    --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    --box-shadow: 0 1px 2px rgba(0,0,0,0.05); /* Telegram é˜´å½±è¾ƒè½» */
    --special-contact-color: var(--tg-ai-contact-primary); /* é»˜è®¤ç‰¹æ®Šè”ç³»äººé¢œè‰² */
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
    font-family: var(--font-family), serif;
    background-color: var(--tg-background-main);
    color: var(--text-color);
    line-height: 1.5; /* Telegram è¡Œè·è¾ƒç´§å‡‘ */
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background-image: linear-gradient(to bottom, #eff3f6, #dde2e7);
}

.app-container {
    display: flex;
    width: 100%;
    max-width: 1400px;
    background-color: var(--secondary-color); /* ä¾§è¾¹æ èƒŒæ™¯è‰² */
    box-shadow: 0 1px 5px rgba(0,0,0,0.1);
    border-radius: var(--border-radius);
    border: 1px solid var(--border-color);
    overflow: hidden;
}

/* --- æ»šåŠ¨æ¡ç¾åŒ– (Telegram é£æ ¼ç»†æ»šåŠ¨æ¡) --- */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.2); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: rgba(0,0,0,0.3); }

/* --- Sidebar Navigation --- */
.sidebar-nav {
    background-color: var(--secondary-color); /* --tg-background-sidebar */
    border-right: 1px solid var(--border-color);
}
.sidebar-header {
    padding: 8px 12px; /* ç•¥å¾®ç´§å‡‘ */
    height: var(--header-height);
    background-color: var(--secondary-color);
}
.menu-btn { color: var(--tg-icon-gray); margin-right: 15px; }
.menu-btn:hover { color: var(--primary-color); }
.search-bar {
    background-color: var(--tg-background-main); /* æœç´¢æ¡†ç”¨æ›´æµ…çš„ç°è‰² */
    border: 1px solid transparent; /* æ— è¾¹æ¡†ï¼Œç„¦ç‚¹æ—¶æ˜¾ç¤º */
    color: var(--text-color);
    border-radius: 18px;
    padding: 7px 12px;
}
.search-bar::placeholder { color: var(--text-color-light); }
.search-bar:focus {
    border-color: var(--primary-color);
    background-color: var(--tg-received-bubble); /* ç„¦ç‚¹æ—¶ç™½è‰² */
    box-shadow: 0 0 0 1px var(--primary-color);
}
.nav-tabs { border-bottom: 1px solid var(--border-color); padding: 8px 0; }
.nav-tab { color: var(--text-color-light); font-weight: 500; padding: 6px 10px; }
.nav-tab:hover { color: var(--primary-color); }
.nav-tab.active { color: var(--primary-color); border-bottom-color: var(--primary-color); }

.chat-list-item { padding: 8px 12px; border-bottom: 1px solid var(--border-color); }
.chat-list-item:hover { background-color: var(--hover-bg-color); }

/* æ™®é€šé€‰ä¸­ (éAIè§’è‰²) */
.chat-list-item.active:not(.special-contact) { /* ç¡®ä¿ä¸å½±å“AIè§’è‰²çš„ç‰¹æ®Šé€‰ä¸­æ ·å¼ */
    background-color: var(--active-bg-color); /* å³ var(--primary-color) */
}
.chat-list-item.active:not(.special-contact) .chat-list-name,
.chat-list-item.active:not(.special-contact) .chat-list-preview,
.chat-list-item.active .chat-list-name:not(.special-contact .chat-list-name),
.chat-list-item.active:not(.special-contact) .chat-list-time {
    color: var(--text-color-inverted); /* é€‰ä¸­é¡¹æ–‡å­—åç™½ */
}

.chat-list-avatar {
    width: 42px; height: 42px; /* Telegram å¤´åƒç•¥å¤§ */
    background-color: var(--tg-light-blue-secondary); /* é»˜è®¤å¤´åƒèƒŒæ™¯ */
    color: var(--text-color-inverted);
    font-size: 18px;
}

/* --- AI è§’è‰²ç‰¹å®šæ ·å¼ (AI_CONTACT_CLASS æ˜¯ä¸€ä¸ªå ä½ç¬¦, JSä¼šæ›¿æ¢æˆå…·ä½“è§’è‰²ç±»å) --- */
.chat-list-item.special-contact.AI_CONTACT_CLASS .chat-list-avatar,
.chat-avatar-main.AI_CONTACT_CLASS, .details-avatar.AI_CONTACT_CLASS, #callingModalAvatar.AI_CONTACT_CLASS {
    background-color: var(--tg-ai-contact-primary);
    color: var(--tg-ai-avatar-text);
}

/* AI è§’è‰²åˆ—è¡¨é€‰ä¸­ */
.chat-list-item.active.AI_CONTACT_CLASS {
    background-color: var(--tg-ai-contact-primary);
    /* å¦‚æœæƒ³è®©AIé€‰ä¸­èƒŒæ™¯æ›´æ·¡ï¼Œå¯ä»¥ç”¨: background-color: var(--tg-ai-contact-secondary); */
}

/* AI è§’è‰²é€‰ä¸­çš„åˆ—è¡¨é¡¹å†…çš„æ–‡å­—é¢œè‰² */
.chat-list-item.active.AI_CONTACT_CLASS .chat-list-name,
.chat-list-item.active.AI_CONTACT_CLASS .chat-list-preview,
.chat-list-item.active.AI_CONTACT_CLASS .chat-list-time {
    color: var(--tg-ai-text-on-light-selection-bg); /* ä½¿ç”¨æ·±è‰²æ–‡å­—ä»¥ä¿è¯åœ¨å„ç§AIä¸»è‰²èƒŒæ™¯ä¸‹çš„å¯è¯»æ€§ */
}
/* å¦‚æœ --tg-ai-contact-primary æ€»æ˜¯æ·±è‰²ï¼Œåˆ™ç”¨ä¸‹é¢è¿™è¡Œæ›¿æ¢ä¸Šé¢çš„ color è§„åˆ™: */
/* color: var(--tg-ai-avatar-text); */


.chat-header-main.current-chat-AI_CONTACT_CLASS .chat-title-main { color: var(--tg-ai-message-sender); }
.message.received[data-sender-id^="AI_"] .message-sender { color: var(--tg-ai-message-sender); }
.details-panel.AI_CONTACT_CLASS #aiContactAboutSection h4 span,
.details-panel.AI_CONTACT_CLASS #detailsName { color: var(--tg-ai-contact-primary); }


.chat-list-badge {
    background-color: var(--primary-color); /* å¾½æ ‡ç”¨ä¸»è“è‰² */
    color: var(--text-color-inverted);
    border-radius: 12px; /* æ›´åœ†çš„å¾½ç«  */
    padding: 1px 7px;
    font-size: 11px;
    min-width: 20px;
    line-height: 1.5;
}
.new-chat-fab {
    background-color: var(--primary-color);
    color: var(--text-color-inverted);
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    width: 56px; height: 56px;
}
.new-chat-fab:hover { background-color: var(--primary-color-dark); }

/* --- Main Chat Area --- */
.chat-area {
    background-color: var(--tg-background-chat);
    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAAoAQMAAAAChZ4TAAAABlBMVEUKCoP///8vjBuaAAAAAXRSTlMAQObYZgAAABZJREFUOI1jYMAHGAwYFBgMGADdGgAnEQJ1YQAAAABJRU5ErkJggg==");
    background-repeat: repeat;
    background-size: 320px 32px;
    background-blend-mode: overlay;
}
.chat-header-main {
    background-color: var(--secondary-color); /* ä¸ä¾§è¾¹æ ä¸€è‡´ */
    height: var(--header-height);
    border-bottom: 1px solid var(--border-color);
}
.chat-avatar-main { border: none; }
.chat-title-main { font-weight: 500; }
.header-action-btn { color: var(--tg-icon-gray); }
.header-action-btn:hover { color: var(--primary-color); }

.chat-messages-container { padding: 10px 16px; }
.no-chat-selected { color: var(--text-color-light); }
.no-chat-selected .logo-placeholder {
    font-family: var(--font-family), serif;
    content: "ğŸ’¬";
    font-size: 50px;
    color: var(--tg-icon-gray);
    opacity: 0.6;
}
.status-indicator.global {
    background-color: rgba(var(--tg-primary-blue-rgb), 0.1);
    border: none;
    color: var(--primary-color);
    padding: 5px 10px;
    border-radius: 15px;
}

/* æ¶ˆæ¯æ°”æ³¡ */
.message {
    border: none;
    box-shadow: 0 1px 1px rgba(0,0,0,0.08);
    padding: 7px 12px;
    border-radius: var(--border-radius);
    max-width: 75%;
}
.message.sent {
    background-color: var(--sent-bg-color);
    color: var(--text-color);
    border-bottom-right-radius: 2px;
}
.message.received {
    background-color: var(--received-bg-color);
    border-bottom-left-radius: 2px;
}
.message.system {
    background-color: rgba(var(--tg-primary-blue-rgb), 0.12);
    color: var(--primary-color);
    font-style: normal;
    font-size: 13px;
    box-shadow: none;
    border-radius: 15px;
}
.message-sender {
    color: var(--primary-color);
    font-weight: 500;
    font-size: 13px;
    margin-bottom: 2px;
}
.message .timestamp {
    font-size: 11px;
    color: var(--text-color-light);
    opacity: 0.9;
    margin-top: 3px;
}
.message.sent .timestamp { color: #65a052; }


.chat-input-container { background-color: var(--secondary-color); padding: 8px 12px; }
#messageInput {
    background-color: var(--tg-received-bubble);
    border: 1px solid var(--border-color);
    color: var(--text-color);
    border-radius: 18px;
    padding: 9px 15px;
    min-height: 20px;
    line-height: 1.4;
}
#messageInput::placeholder { color: var(--text-color-light); }
#messageInput:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 1px var(--primary-color);
}
.icon-btn { color: var(--tg-icon-gray); padding: 7px; }
.icon-btn:hover { color: var(--primary-color); background-color: transparent; }
#sendButtonMain { color: var(--primary-color); font-weight: 500; }
#sendButtonMain:hover { text-shadow: none; }
#voiceButtonMain.recording { color: var(--danger-color); animation: tg-pulse 1.5s infinite; }
@keyframes tg-pulse {
    0% { box-shadow: 0 0 0 0 rgba(var(--tg-error-red-rgb), 0.5); }
    70% { box-shadow: 0 0 0 8px rgba(var(--tg-error-red-rgb), 0); }
    100% { box-shadow: 0 0 0 0 rgba(var(--tg-error-red-rgb), 0); }
}

/* --- Details Panel --- */
.details-panel { background-color: var(--secondary-color); border-left: 1px solid var(--border-color); }
.details-header { background-color: var(--secondary-color); height: var(--header-height); }
.details-avatar { border: none; }
#detailsName { font-weight: 500; }
#aiContactDetailsContent {
    background-color: var(--tg-background-main);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
}
#aiContactDetailsContent p strong { color: var(--primary-color); border-bottom: none; }
#aiContactBasicInfoList li { border-bottom: 1px dotted rgba(var(--tg-text-primary-rgb), 0.1); }
#aiContactAboutText { color: var(--text-color-light); }

/* é€šç”¨æŒ‰é’®æ ·å¼ */
.btn {
    border-radius: var(--border-radius);
    text-transform: none;
    letter-spacing: 0;
    font-weight: 500;
    transition: background-color 0.15s ease, box-shadow 0.15s ease;
    box-shadow: none;
    padding: 8px 16px;
}
.btn-primary { background-color: var(--primary-color); color: var(--text-color-inverted); border: none; }
.btn-primary:hover { background-color: var(--primary-color-dark); }
.btn-secondary {
    background-color: var(--tg-border-light);
    color: var(--primary-color);
    border: none;
}
.btn-secondary:hover { background-color: #dcdcdc; }
.btn-danger { background-color: var(--danger-color); color: var(--text-color-inverted); border: none; }
.btn-danger:hover { background-color: rgb(200, 40, 40); }
.btn-success { background-color: var(--accent-color); color: var(--text-color-inverted); border: none;}
.btn-success:hover { background-color: rgb(60, 150, 65); }

/* --- Modals --- */
.loading-overlay { background-color: rgba(var(--tg-background-main-rgb), 0.8); }
.loading-spinner {
    border-top-color: var(--primary-color);
    border-left-color: var(--primary-color);
    border-bottom-color: rgba(var(--tg-primary-blue-rgb),0.2);
    border-right-color: rgba(var(--tg-primary-blue-rgb),0.2);
}
.modal-content {
    background-color: var(--secondary-color);
    border: none;
    box-shadow: 0 5px 15px rgba(0,0,0,0.15);
    border-radius: var(--border-radius);
}
.modal-header h2 { color: var(--text-color); font-size: 18px; font-weight: 500; }
.close-modal-btn:hover { color: var(--primary-color); }
.modal-body input[type="text"], .modal-body textarea {
    background-color: var(--tg-received-bubble);
    color: var(--text-color);
    border: 1px solid var(--border-color);
}
.modal-body input[type="text"]:focus, .modal-body textarea:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 1px var(--primary-color);
}
.user-id-display #modalUserIdValue {
    background: var(--tg-background-main);
    color: var(--primary-color);
    border: 1px dashed var(--primary-color);
    font-weight: 500;
}

/* Video Call */
.video-call-avatar { background-color: var(--tg-light-blue-secondary); border: none; }
.video-call-button.end-call { background: var(--danger-color); }
.video-call-button.active { background: var(--primary-color); color: var(--text-color-inverted); }

/* Toggle Switch */
input:checked + .slider { background-color: var(--primary-color); }
.slider { background-color: #bdc1c5; }
.slider:before { background-color: var(--tg-text-white); box-shadow: 0 1px 2px rgba(0,0,0,0.2); }

/* ç¡®ä¿ç‰¹å®šéšè—éƒ¨åˆ†è¢«éšè— */
#detailsPanelContent #aiContactAboutSection,
#detailsPanelContent #detailsGroupManagement #addGroupMemberArea,
#detailsPanelContent #detailsGroupManagement #leftMembersArea,
#detailsPanelContent #groupActionsDetails,
#detailsPanelContent #dissolveGroupBtnDetails,
#mainMenuModal .settings-section.manual-connection-advanced,
#mainMenuModal #modalResetAllConnectionsBtn {
    display: none;
}
/* ç‰¹å®šäºAIè§’è‰²æ˜¾ç¤º"å…³äº"åŒºåŸŸçš„æ ·å¼ */
.details-panel.AI_CONTACT_CLASS #aiContactAboutSection {
    display: block;
}

.details-panel.human-contact-active #contactActionsDetails { display: block; }
.details-panel.group-chat-active #detailsGroupManagement,
.details-panel.group-chat-active #groupActionsDetails { display: block; }

.notification {
    background: var(--tg-received-bubble);
    border-left: 4px solid var(--primary-color);
    color: var(--text-color);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}