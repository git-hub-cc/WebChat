/*
    Theme Name: æ–—ç ´è‹ç©¹ - é­”ç„°å¤œè¡Œ (Dark Mode)
    Description: A dark theme for a chat application inspired by "Battle Through the Heavens",
                 focusing on Heavenly Flames, soul power, and a mysterious nocturnal atmosphere.
*/

:root {
    /* æ–—ç ´è‹ç©¹ - é­”ç„°å¤œè¡Œ ä¸»é¢˜è‰²æ¿ (æ·±è‰²) */
    --dq-dark-heavenly-flame-red-rgb: 210, 70, 40;   /* ç„šå¤©å¼‚ç« (ä¸»å¼ºè°ƒ/äº¤äº’ - Fiery Red) */
    --dq-dark-heavenly-flame-red: rgb(var(--dq-dark-heavenly-flame-red-rgb));
    --dq-dark-heavenly-flame-red-darker-rgb: 180, 50, 20; /* å¹½å†¥ç„°å¿ƒ (æ‚¬æµ®/æ¿€æ´») */
    --dq-dark-heavenly-flame-red-darker: rgb(var(--dq-dark-heavenly-flame-red-darker-rgb));

    --dq-dark-nightsky-black-rgb: 12, 10, 18;        /* æ— å°½å¤œç©º (èƒŒæ™¯ä¸»è‰² - Deep near-black) */
    --dq-dark-nightsky-black: rgb(var(--dq-dark-nightsky-black-rgb));
    --dq-dark-obsidian-panel-rgb: 25, 22, 32;       /* é»‘æ›œçŸ³æ¿ (æ¬¡çº§èƒŒæ™¯/é¢æ¿ - Dark obsidian purple/black) */
    --dq-dark-obsidian-panel: rgb(var(--dq-dark-obsidian-panel-rgb));

    --dq-dark-soul-purple-rgb: 110, 80, 160;        /* çµé­‚å¹½ç´« (æ¬¡å¼ºè°ƒ/ç¥ç§˜ - Soul Purple) */
    --dq-dark-soul-purple: rgb(var(--dq-dark-soul-purple-rgb));
    --dq-dark-ancient-gold-rgb: 190, 140, 50;       /* å¤æœ´æš—é‡‘ (ç‚¹ç¼€/é«˜å…‰ - Muted Gold) */
    --dq-dark-ancient-gold: rgb(var(--dq-dark-ancient-gold-rgb));

    --dq-dark-demonic-cyan-flame-rgb: 50, 140, 170; /* é­”ç„°é’è² (è§ç‚/ç‚¹ç¼€ - Dark Cyan Flame) */
    --dq-dark-demonic-cyan-flame: rgb(var(--dq-dark-demonic-cyan-flame-rgb));

    --dq-dark-danger-crimson-rgb: 170, 30, 40;       /* ç…æ°”æ·±çº¢ (æˆ˜æ–—/å±é™© - Deep Crimson) */
    --dq-dark-danger-crimson: rgb(var(--dq-dark-danger-crimson-rgb));

    --dq-dark-text-ash-white-rgb: 220, 225, 230;     /* ç°çƒ¬äº®ç™½ (ä¸»è¦æ–‡å­— - Ash White) */
    --dq-dark-text-ash-white: rgb(var(--dq-dark-text-ash-white-rgb));
    --dq-dark-text-shadow-gray-rgb: 140, 145, 155;   /* æš—å½±æ·¡ç° (æ¬¡è¦æ–‡å­— - Shadow Gray) */
    --dq-dark-text-shadow-gray: rgb(var(--dq-dark-text-shadow-gray-rgb));

    --dq-dark-volcanic-border-rgb: 45, 42, 55;      /* ç«å±±ç„æ­¦å²© (è¾¹æ¡† - Dark Volcanic Rock) */
    --dq-dark-volcanic-border: rgb(var(--dq-dark-volcanic-border-rgb));


    /* è§’è‰²ç‰¹å®šé¢œè‰² (æ·±è‰²) - é­”ç„°å¤œè¡Œ */
    /* è§ç‚ - é»‘é‡‘ã€é’è²è‰²ã€ç«çº¢è‰² */
    --dq-xiaoyan-primary-dark-rgb: 30,30,30; /* æ·±é‚ƒé­”é»‘ */
    --dq-xiaoyan-primary-dark: rgb(var(--dq-xiaoyan-primary-dark-rgb));
    --dq-xiaoyan-secondary-dark: rgba(var(--dq-xiaoyan-primary-dark-rgb), 0.3);
    --dq-xiaoyan-accent-gold-dark: var(--dq-dark-ancient-gold); /* æš—é‡‘ */
    --dq-xiaoyan-accent-cyan-dark: var(--dq-dark-demonic-cyan-flame); /* é­”ç„°é’è² */
    --dq-xiaoyan-accent-fire-dark: var(--dq-dark-heavenly-flame-red); /* ç„šå¤©å¼‚ç« */

    /* è¯è€ - é“¶ç™½ã€æ·¡ç´«ã€çµé­‚è“ */
    --dq-yaolao-primary-dark-rgb: 230,235,240; /* é­‚ä½“è§ç™½ (æ›´äº®) */
    --dq-yaolao-primary-dark: rgb(var(--dq-yaolao-primary-dark-rgb));
    --dq-yaolao-secondary-dark: rgba(var(--dq-yaolao-primary-dark-rgb), 0.08);
    --dq-yaolao-accent-purple-dark-rgb: var(--dq-dark-soul-purple-rgb); /* <<< RGB for è¯è€å¹½ç´« */
    --dq-yaolao-accent-purple-dark: rgb(var(--dq-yaolao-accent-purple-dark-rgb));
    --dq-yaolao-accent-soulblue-dark-rgb: 100, 150, 210; /* <<< RGB for è¯è€æ·±é‚ƒé­‚è“ */
    --dq-yaolao-accent-soulblue-dark: rgb(var(--dq-yaolao-accent-soulblue-dark-rgb));

    /* ç¾æœèå¥³ç‹ - å¦–ç´«ã€ç«çº¢ã€æš—é‡‘ */
    --dq-medusa-primary-dark-rgb: 100, 60, 130; /* å¥³ç‹å†¥ç´« (æ›´æ·±é‚ƒ) */
    --dq-medusa-primary-dark: rgb(var(--dq-medusa-primary-dark-rgb));
    --dq-medusa-secondary-dark: rgba(var(--dq-medusa-primary-dark-rgb), 0.2);
    --dq-medusa-accent-rose-dark: rgb(180, 50, 100); /* è¡€è‰²å¦–ç« */
    --dq-medusa-accent-darkgold-dark: var(--dq-dark-ancient-gold); /* å¹½å†¥æš—é‡‘ */

    /* äº‘éŸµ - å¤©è“ã€æ·¡é‡‘ */
    --dq-yunyun-primary-dark-rgb: 90, 150, 170; /* é£éšç„é’ (åŸé£é’è‰²) */
    --dq-yunyun-primary-dark: rgb(var(--dq-yunyun-primary-dark-rgb));
    --dq-yunyun-secondary-dark: rgba(var(--dq-yunyun-primary-dark-rgb), 0.15);
    --dq-yunyun-accent-gold-dark: rgb(160, 120, 40); /* å®—é—¨å¹½é‡‘ */

    /* çº³å…°å«£ç„¶ - æµ…ç´«ã€ç«çº¢ */
    --dq-nalan-primary-dark-rgb: 150, 120, 180; /* æœˆä¸‹å ‡ç´« */
    --dq-nalan-primary-dark: rgb(var(--dq-nalan-primary-dark-rgb));
    --dq-nalan-secondary-dark: rgba(var(--dq-nalan-primary-dark-rgb), 0.2);
    --dq-nalan-accent-rose-dark: rgb(190, 70, 100); /* å¤œå½±ç«çº¢ */

    /* è§è–°å„¿ - é‡‘é»„ã€èµ¤ç„° */
    --dq-xuner-primary-dark-rgb: 180, 130, 40; /* å¤å¸æš—é‡‘ (åŸé‡‘è‰²) */
    --dq-xuner-primary-dark: rgb(var(--dq-xuner-primary-dark-rgb));
    --dq-xuner-secondary-dark: rgba(var(--dq-xuner-primary-dark-rgb), 0.2);
    --dq-xuner-accent-flame-dark: var(--dq-dark-heavenly-flame-red); /* è¡€è„‰èµ¤ç„° */

    /* é­‚æ®¿ - æ·±ç´«ã€é»‘ç„° */
    --dq-soulhall-primary-dark-rgb: 70, 50, 100; /* é­‚åŸŸå†¥ç´« */
    --dq-soulhall-primary-dark: rgb(var(--dq-soulhall-primary-dark-rgb));
    --dq-soulhall-secondary-dark: rgba(var(--dq-soulhall-primary-dark-rgb), 0.15);
    --dq-soulhall-accent-blackflame-dark-rgb: 30, 20, 40; /* å¹½å†¥é»‘ç„° */
    --dq-soulhall-accent-blackflame-dark: rgb(var(--dq-soulhall-accent-blackflame-dark-rgb));

    /* éŸ©æ« - æš—çº¢ã€ç°é»‘ */
    --dq-hanfeng-primary-dark-rgb: 130, 30, 30; /* å™¬é­‚è¡€çº¢ */
    --dq-hanfeng-primary-dark: rgb(var(--dq-hanfeng-primary-dark-rgb));
    --dq-hanfeng-secondary-dark: rgba(var(--dq-hanfeng-primary-dark-rgb), 0.2);
    --dq-hanfeng-accent-grayblack-dark-rgb: 50, 50, 50; /* æ­»å¯‚å†¥é»‘ */
    --dq-hanfeng-accent-grayblack-dark: rgb(var(--dq-hanfeng-accent-grayblack-dark-rgb));

    /* æ—ä¿®å´– - é’ç°ã€é“ç»¿ (ç‚¼è¯å¸ˆ) */
    --dq-linxiuya-primary-dark-rgb: 100, 120, 110; /* æš—æ—é’ç° */
    --dq-linxiuya-primary-dark: rgb(var(--dq-linxiuya-primary-dark-rgb));
    --dq-linxiuya-secondary-dark: rgba(var(--dq-linxiuya-primary-dark-rgb), 0.15);
    --dq-linxiuya-accent-irongreen-dark-rgb: 60, 100, 70; /* ç„é“å¤ç»¿ */
    --dq-linxiuya-accent-irongreen-dark: rgb(var(--dq-linxiuya-accent-irongreen-dark-rgb));

    /* å…¶ä»–è§’è‰² (ä»åŸCSSä¸­ä¿ç•™ï¼Œå¯æŒ‰éœ€è°ƒæ•´) */
    --btth-xiaoyixian-primary-dark: rgb(110, 110, 120); /* å„éš¾ç° */
    --btth-xiaoyixian-secondary-dark: rgba(110, 110, 120, 0.15);
    --btth-haibodong-primary-dark: rgb(100, 170, 220); /* å†°è“ (æš—è°ƒ) */
    --btth-haibodong-secondary-dark: rgba(100, 170, 220, 0.15);
    --btth-ziyan-primary-dark: rgb(160, 90, 200); /* å¤é¾™ç´« */
    --btth-ziyan-secondary-dark: rgba(160, 90, 200, 0.15);

    /* è¦†ç›– Chat åŸæœ‰å˜é‡ */
    --primary-color: var(--dq-dark-heavenly-flame-red); /* ä¸»äº¤äº’ä¸ºå¼‚ç«çº¢ */
    --primary-color-rgb: var(--dq-dark-heavenly-flame-red-rgb); /* <<< FIXED: Added this definition */
    --primary-color-dark: var(--dq-dark-heavenly-flame-red-darker);
    --secondary-color: var(--dq-dark-obsidian-panel); /* åº”ç”¨ä¸»èƒŒæ™¯ */
    --text-color: var(--dq-dark-text-ash-white);
    --text-color-light: var(--dq-dark-text-shadow-gray);
    --text-color-inverted: var(--dq-dark-nightsky-black); /* çº¢è‰²æŒ‰é’®ä¸Šçš„é»‘è‰²æ–‡å­— */
    --accent-color: var(--dq-dark-soul-purple); /* æ¬¡å¼ºè°ƒä¸ºçµé­‚ç´« */
    --danger-color: var(--dq-dark-danger-crimson);
    --warning-color: #B8860B; /* æš—é‡‘é»„è‰²è­¦å‘Š */

    --sent-bg-color: rgba(var(--dq-dark-nightsky-black-rgb), 0.75); /* å‘é€æ¶ˆæ¯ - æ·±é‚ƒå¤œç©º */
    --received-bg-color: rgba(var(--dq-dark-volcanic-border-rgb), 0.9); /* æ¥æ”¶æ¶ˆæ¯ - ç«å±±å²© */

    --border-color: rgba(var(--dq-dark-volcanic-border-rgb), 0.7);
    --hover-bg-color: rgba(var(--dq-dark-text-ash-white-rgb), 0.04);
    --active-bg-color: rgba(var(--dq-dark-heavenly-flame-red-rgb), 0.18);
    --border-radius: 5px; /* ç»Ÿä¸€åœ†è§’ */
    --font-family: "LXGW WenKai TC", "STKaiti", "SimSun", "Noto Serif SC", "Songti SC", serif;
    --box-shadow: 0 2px 4px rgba(0,0,0,0.7), 0 0 20px rgba(var(--dq-dark-heavenly-flame-red-rgb),0.12) inset;
    --special-contact-color: var(--dq-xiaoyan-primary-dark); /* é»˜è®¤è§ç‚é»‘ */
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
    font-family: var(--font-family), serif;
    background-color: var(--dq-dark-nightsky-black); /* æœ€åº•å±‚èƒŒæ™¯ */
    color: var(--text-color);
    line-height: 1.6;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    /* å¼‚ç«ç„šå¤© + é­”ç„°å¤œè¡Œ */
    background:
            radial-gradient(ellipse at center, rgba(var(--dq-dark-heavenly-flame-red-rgb),0.12) 0%, var(--dq-dark-nightsky-black) 75%),
            linear-gradient(to bottom right, rgba(var(--dq-dark-nightsky-black-rgb),0.9), rgba(var(--dq-dark-obsidian-panel-rgb),0.8)),
            radial-gradient(ellipse at top right, rgba(var(--dq-dark-soul-purple-rgb),0.15) 0%, transparent 60%),
            radial-gradient(ellipse at bottom left, rgba(var(--dq-dark-demonic-cyan-flame-rgb),0.1) 0%, transparent 70%);
    background-blend-mode: overlay, normal, soft-light, soft-light;
}

.app-container {
    display: flex;
    /* é­”ç„°æ™¶çŸ³æˆ–é­‚æ®¿ç¥­å› */
    background-color: var(--secondary-color);
    border-radius: var(--border-radius);
    border: 1px solid rgba(var(--dq-dark-volcanic-border-rgb), 0.6);
    box-shadow: 0 8px 30px rgba(0,0,0,0.6),
    0 0 0 3px rgba(var(--dq-dark-heavenly-flame-red-rgb), 0.25); /* é­”ç„°å¤–æ¡† */
    overflow: hidden;
}

/* --- æ»šåŠ¨æ¡ç¾åŒ– (é­‚æ®¿é”é“¾é£æ ¼) --- */
::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-track {
    background: rgba(var(--dq-dark-nightsky-black-rgb), 0.8);
    border-radius: var(--border-radius);
    border: 1px solid rgba(var(--dq-dark-volcanic-border-rgb), 0.3);
}
::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, var(--dq-dark-heavenly-flame-red), var(--dq-dark-soul-purple));
    border-radius: var(--border-radius);
    border: 1px solid rgba(var(--dq-dark-text-ash-white-rgb), 0.05);
}
::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(135deg, var(--dq-dark-heavenly-flame-red-darker), rgba(var(--dq-dark-soul-purple-rgb),0.7));
}


/* --- Sidebar Navigation (ç„å²©é»‘æˆ–é­‚æ®¿æš—ç´«) --- */
.sidebar-nav {
    background-color: rgba(var(--dq-dark-nightsky-black-rgb), 0.7); /* ç„å²©é»‘æ„Ÿ */
    border-right: 1px solid var(--border-color);
    position: relative;
    box-shadow: 2px 0 8px rgba(0,0,0, 0.3);
}
.sidebar-header {
    background-color: rgba(var(--dq-dark-nightsky-black-rgb), 0.85);
    border-bottom: 1px solid var(--border-color);
}
.menu-btn { color: var(--text-color-light); }
.menu-btn:hover { color: var(--primary-color); }

/* æœç´¢æ¡† - é­‚åŠ›æ¢çŸ¥ */
.search-bar {
    background-color: rgba(var(--dq-dark-nightsky-black-rgb), 0.95);
    border: 1px solid var(--border-color);
    color: var(--text-color);
    border-radius: var(--border-radius);
    padding: 8px 12px 8px 30px; /* Space for pseudo icon */
    position: relative;
}
.search-bar::before { /* é­‚åŠ›æ¢çŸ¥/æœç´¢å›¾æ ‡æ„å¢ƒ */
    content: "é­‚"; /* æˆ– 'ğŸ”' */
    font-family: 'Times New Roman', serif;
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-color-light);
    font-size: 0.9em;
    opacity: 0.6;
}
.search-bar::placeholder { color: var(--text-color-light); }
.search-bar:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(var(--dq-dark-heavenly-flame-red-rgb),0.3),
    0 0 8px rgba(var(--dq-dark-soul-purple-rgb),0.2) inset;
}
.search-bar:focus::before {
    color: var(--primary-color);
}

.nav-tabs { border-bottom: 1px solid var(--border-color); }
.nav-tab { color: var(--text-color-light); }
.nav-tab:hover { color: var(--primary-color); }
.nav-tab.active {
    color: var(--primary-color);
    border-bottom: 2px solid var(--primary-color);
    font-weight: 600;
    background-image: linear-gradient(to top, rgba(var(--dq-dark-heavenly-flame-red-rgb), 0.1), transparent);
}

/* é­”ç„°æ‚¬æµ®é«˜äº®æ•ˆæœ */
.chat-list-item {
    border-bottom: 1px solid var(--border-color);
    transition: background-color 0.2s ease, box-shadow 0.2s ease;
}
.chat-list-item:hover {
    background-color: var(--hover-bg-color);
    box-shadow: inset 3px 0 0 0 var(--dq-dark-soul-purple); /* çµé­‚ç´«é«˜å…‰ */
}
.chat-list-item.active {
    background-color: var(--active-bg-color);
    box-shadow: inset 3px 0 0 0 var(--primary-color), /* å¼‚ç«ä¸»è‰² */
    0 0 12px rgba(var(--dq-dark-heavenly-flame-red-rgb), 0.2) inset; /* å†…éƒ¨ç„°å…‰ */
}
.chat-list-item.active .chat-list-name { color: var(--primary-color); font-weight: bold; }

/* è§’è‰²é­”æ°”/é­‚åŠ›ç¯ç»• */
.chat-list-avatar {
    background-color: var(--dq-dark-volcanic-border);
    font-family: "LXGW WenKai TC", serif;
    border: 2px solid transparent; /* Base for aura */
    color: var(--dq-dark-text-ash-white);
    box-shadow: 0 0 4px rgba(0,0,0, 0.5);
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
}
.chat-list-item:hover .chat-list-avatar {
    border-color: rgba(var(--dq-dark-soul-purple-rgb), 0.6);
    box-shadow: 0 0 6px rgba(var(--dq-dark-soul-purple-rgb), 0.4);
}
.chat-list-item.active .chat-list-avatar {
    border-color: var(--primary-color);
    box-shadow: 0 0 8px rgba(var(--dq-dark-heavenly-flame-red-rgb), 0.5);
}

/* é­‚ç«é—ªçƒæé†’ */
.chat-list-badge {
    background-color: var(--dq-dark-danger-crimson);
    color: var(--dq-dark-text-ash-white);
    box-shadow: 0 0 8px rgba(var(--dq-dark-danger-crimson-rgb), 0.8);
    animation: dq-dark-soulfire-pulse 1.8s infinite ease-in-out;
    border: 1px solid rgba(var(--dq-dark-text-ash-white-rgb),0.3);
}
@keyframes dq-dark-soulfire-pulse {
    0%, 100% { transform: scale(1); opacity: 1; filter: brightness(1); }
    50% { transform: scale(1.15); opacity: 0.85; filter: brightness(1.3); }
}

.new-chat-fab {
    background: linear-gradient(135deg, var(--dq-dark-heavenly-flame-red), var(--dq-dark-soul-purple));
    color: var(--dq-dark-text-ash-white);
    box-shadow: 0 3px 10px rgba(0,0,0,0.5),
    0 0 12px rgba(var(--dq-dark-heavenly-flame-red-rgb),0.4),
    0 0 10px rgba(var(--dq-dark-soul-purple-rgb),0.3);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.new-chat-fab:hover {
    background: linear-gradient(135deg, var(--dq-dark-heavenly-flame-red-darker), var(--dq-dark-soul-purple));
    transform: translateY(-2px) scale(1.05);
    box-shadow: 0 5px 15px rgba(0,0,0,0.6),
    0 0 18px rgba(var(--dq-dark-heavenly-flame-red-rgb),0.5),
    0 0 15px rgba(var(--dq-dark-soul-purple-rgb),0.4);
}


/* --- Main Chat Area (é­”ç„°ç»“ç•Œæˆ–é­‚æµ·ç©ºé—´) --- */
.chat-area {
    background-color: var(--secondary-color);
}
/* é¡¶éƒ¨åŠ å…¥é­”çº¹çº¿æ¡ */
.chat-header-main {
    background-color: rgba(var(--dq-dark-nightsky-black-rgb), 0.6);
    border-bottom: 1px solid var(--border-color);
    position: relative;
}
.chat-header-main::after { /* é­”çº¹çº¿æ¡ */
    content: '';
    position: absolute;
    bottom: -1px;
    left: 50%;
    transform: translateX(-50%);
    width: 35%;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--primary-color), var(--dq-dark-soul-purple), transparent);
    opacity: 0.8;
    filter: blur(0.5px);
}
.chat-avatar-main {
    border: 2px solid var(--dq-dark-volcanic-border);
    box-shadow: 0 1px 5px rgba(0,0,0, 0.4);
}
.chat-title-main {
    font-weight: 600;
    text-shadow: 0 0 10px rgba(var(--primary-color-rgb), 0.3);
}
.header-action-btn { color: var(--text-color-light); }
.header-action-btn:hover {
    color: var(--primary-color);
    text-shadow: 0 0 6px rgba(var(--primary-color-rgb), 0.6);
}

.chat-messages-container { padding: 15px; }

/* Placeholder: ç”¨â€œç‚â€å­— */
.no-chat-selected .logo-placeholder {
    font-family: "LXGW WenKai TC", serif;
    font-size: 8em;
    font-weight: bold;
    color: rgba(var(--dq-dark-heavenly-flame-red-rgb), 0.2);
    text-shadow: 0 0 15px rgba(var(--dq-dark-soul-purple-rgb),0.2),
    1px 1px 0px rgba(var(--dq-dark-volcanic-border-rgb),0.8),
    0 0 25px rgba(var(--dq-dark-heavenly-flame-red-rgb),0.3);
}
.no-chat-selected .logo-placeholder::before {
}
.status-indicator.global {
    background-color: rgba(var(--dq-dark-nightsky-black-rgb), 0.7);
    border: 1px solid var(--border-color);
    color: var(--primary-color);
    box-shadow: 0 0 6px rgba(var(--primary-color-rgb),0.3);
}

/* æ¶ˆæ¯æ°”æ³¡ - é­”ç„°ç¾½çº¹ */
.message {
    border: 1px solid var(--border-color);
    box-shadow: var(--box-shadow);
    border-radius: var(--border-radius);
    position: relative;
    padding: 10px 15px;
}
/* ç„šå¤©å¼‚ç«åŒ…è£¹ */
.message.sent {
    background-color: var(--sent-bg-color);
    border-left: 3px solid var(--primary-color);
    color: var(--text-color);
    border-radius: var(--border-radius) 0px var(--border-radius) var(--border-radius);
}
.message.sent::after { /* é­”ç„°è½¨è¿¹ */
    content: '';
    position: absolute;
    top: 0;
    left: -1px;
    bottom: 0;
    width: 5px;
    background: linear-gradient(to bottom, rgba(var(--dq-dark-heavenly-flame-red-rgb),0.4) 0%, rgba(var(--dq-dark-soul-purple-rgb),0.3) 70%, transparent 100%);
    border-radius: 3px 0 0 3px;
    opacity: 0.7;
    filter: blur(0.5px);
}
/* è§’è‰²ä¸“å±é­‚åŠ›è‰²å½© */
.message.received {
    background-color: var(--received-bg-color);
    border-right: 3px solid var(--dq-dark-volcanic-border); /* Default, overridden by character */
    color: var(--text-color);
    border-radius: 0px var(--border-radius) var(--border-radius) var(--border-radius);
}
/* é­‚å°/ç¦åˆ¶æ ·å¼ */
.message.system {
    background-color: rgba(var(--dq-dark-obsidian-panel-rgb), 0.85);
    color: var(--dq-dark-soul-purple);
    font-style: italic;
    border: 1px dashed var(--dq-dark-soul-purple);
    box-shadow: 0 0 10px rgba(var(--dq-dark-soul-purple-rgb),0.2) inset,
    0 1px 3px rgba(0,0,0, 0.3);
    text-align: center;
}
.message-sender {
    color: var(--text-color-light);
    font-weight: 600;
    margin-bottom: 4px;
    display: block;
}
.message .timestamp { color: var(--text-color-light); opacity: 0.65; font-size: 0.8em; }

/* è¾“å…¥åŒº - ç¥­å›é»‘æ›œçŸ³è¾¹æ¡† */
.chat-input-container {
    background-color: rgba(var(--dq-dark-nightsky-black-rgb), 0.75);
    border-top: 1px solid var(--border-color);
    padding: 10px;
    box-shadow: 0 -2px 5px rgba(0,0,0,0.2);
}
#messageInput {
    background-color: rgba(var(--dq-dark-nightsky-black-rgb), 0.9);
    border: 1px solid var(--dq-dark-volcanic-border);
    color: var(--text-color);
    border-radius: var(--border-radius);
    padding: 10px;
    box-shadow: inset 0 1px 4px rgba(0,0,0,0.3);
}
#messageInput::placeholder { color: var(--text-color-light); }
#messageInput:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(var(--dq-dark-heavenly-flame-red-rgb),0.35),
    inset 0 1px 5px rgba(var(--dq-dark-heavenly-flame-red-rgb),0.15);
}
.icon-btn { color: var(--text-color-light); transition: color 0.2s, background-color 0.2s; }
.icon-btn:hover {
    color: var(--primary-color);
    background-color: rgba(var(--dq-dark-heavenly-flame-red-rgb),0.1);
}
/* å‘é€æŒ‰é’® - ç‡ƒçƒ§é­”ç„°ï¼Œæ‚¬æµ®æ—¶ç„°å…‰å¤§ç›› */
#sendButtonMain {
    color: var(--primary-color);
    font-weight: 600;
    transition: text-shadow 0.2s ease, color 0.2s ease;
}
#sendButtonMain:hover {
    color: var(--dq-dark-heavenly-flame-red-darker);
    text-shadow: 0 0 8px rgba(var(--dq-dark-heavenly-flame-red-rgb), 0.8), /* ä¸»ç„°å…‰ */
    0 0 15px rgba(var(--dq-dark-soul-purple-rgb),0.5); /* æ¬¡çº§é­‚å…‰ */
}
#voiceButtonMain.recording {
    color: var(--danger-color);
    animation: dq-dark-demonic-pulse 1.5s infinite;
}
@keyframes dq-dark-demonic-pulse {
    0% { box-shadow: 0 0 0 0 rgba(var(--dq-dark-danger-crimson-rgb), 0.8); }
    70% { box-shadow: 0 0 0 14px rgba(var(--dq-dark-danger-crimson-rgb), 0); }
    100% { box-shadow: 0 0 0 0 rgba(var(--dq-dark-danger-crimson-rgb), 0); }
}

/* --- Details Panel (å¹½å†¥ç„æ™¶æˆ–é­‚æ¸Šæš—è‰²) --- */
.details-panel {
    background-color: rgba(var(--dq-dark-nightsky-black-rgb), 0.8); /* é­‚æ¸Šæš—è‰² */
    border-left: 1px solid var(--border-color);
    box-shadow: -2px 0 8px rgba(0,0,0, 0.3);
}
.details-header {
    background-color: rgba(var(--dq-dark-obsidian-panel-rgb), 0.7);
    border-bottom: 1px solid var(--border-color);
}
/* è§’è‰²ä¿¡æ¯ - é­‚åŠ›/é­”ç„°åŠ¨æ€è¾¹æ¡† */
.details-avatar {
    border: 3px solid transparent;
    box-shadow: 0 0 12px rgba(0,0,0, 0.4);
    transition: border-color 0.4s ease, box-shadow 0.4s ease;
    border-image: linear-gradient(60deg, var(--dq-dark-heavenly-flame-red), var(--dq-dark-soul-purple)) 1;
}
.details-panel.character-active .details-avatar {
    animation: dq-dark-power-glow 3s infinite alternate;
}
@keyframes dq-dark-power-glow {
    from {
        border-image: linear-gradient(60deg, var(--dq-dark-heavenly-flame-red), var(--dq-dark-soul-purple)) 1;
        box-shadow: 0 0 15px rgba(var(--dq-dark-heavenly-flame-red-rgb),0.4), 0 0 10px rgba(var(--dq-dark-soul-purple-rgb),0.3);
    }
    to {
        border-image: linear-gradient(60deg, var(--dq-dark-soul-purple), var(--dq-dark-heavenly-flame-red)) 1;
        box-shadow: 0 0 20px rgba(var(--dq-dark-soul-purple-rgb),0.4), 0 0 12px rgba(var(--dq-dark-heavenly-flame-red-rgb),0.3);
    }
}

#detailsName {
    text-shadow: 0 1px 3px rgba(0,0,0, 0.5);
    font-weight: 700;
}
#aiContactDetailsContent {
    background-color: rgba(var(--dq-dark-obsidian-panel-rgb), 0.55);
    border: 1px solid rgba(var(--dq-dark-volcanic-border-rgb), 0.4);
    border-radius: var(--border-radius);
    padding: 15px;
    margin: 10px;
}
#aiContactDetailsContent p strong {
    color: var(--primary-color);
    border-bottom: 1px solid rgba(var(--primary-color-rgb), 0.3);
    padding-bottom: 1px;
}
#aiContactBasicInfoList li {
    border-bottom: 1px dotted rgba(var(--dq-dark-text-ash-white-rgb), 0.12);
    padding: 8px 0;
}
#aiContactAboutText { color: var(--text-color-light); font-size: 0.9em; line-height: 1.7; }


/* --- è§’è‰²ç‰¹å®šæ ·å¼ (æ·±è‰² - é­”ç„°å¤œè¡Œ) --- */

/* ğŸ’ è§ç‚ - é»‘é‡‘ã€é’è²ã€ç«çº¢ ğŸ’ */
.chat-list-item.special-contact.AI_è§ç‚_æ–—ç ´è‹ç©¹ .chat-list-avatar,
.chat-avatar-main.AI_è§ç‚_æ–—ç ´è‹ç©¹, .details-avatar.AI_è§ç‚_æ–—ç ´è‹ç©¹, #callingModalAvatar.AI_è§ç‚_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-xiaoyan-primary-dark);
    color: var(--dq-xiaoyan-accent-gold-dark);
    border-color: var(--dq-xiaoyan-accent-cyan-dark);
    box-shadow: 0 0 8px var(--dq-xiaoyan-accent-cyan-dark), 0 0 5px var(--dq-xiaoyan-accent-gold-dark) inset, 0 0 10px var(--dq-xiaoyan-accent-fire-dark);
    text-shadow: 0 0 4px var(--dq-xiaoyan-accent-gold-dark);
}
.chat-list-item.active.AI_è§ç‚_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-xiaoyan-secondary-dark);
    box-shadow: inset 3px 0 0 0 var(--dq-xiaoyan-accent-fire-dark),
    0 0 12px rgba(var(--dq-xiaoyan-primary-dark-rgb), 0.5) inset;
}
.chat-list-item.active.AI_è§ç‚_æ–—ç ´è‹ç©¹ .chat-list-name { color: var(--dq-xiaoyan-accent-fire-dark); }
.chat-header-main.current-chat-AI_è§ç‚_æ–—ç ´è‹ç©¹ .chat-title-main {
    color: var(--dq-xiaoyan-accent-fire-dark);
    text-shadow: 0 0 5px var(--dq-xiaoyan-accent-cyan-dark), 0 0 8px var(--dq-xiaoyan-accent-gold-dark);
}
.message.received[data-sender-id="AI_è§ç‚_æ–—ç ´è‹ç©¹"] {
    border-right-color: var(--dq-xiaoyan-accent-cyan-dark);
    background-color: rgba(var(--dq-xiaoyan-primary-dark-rgb), 0.2);
}
.message.received[data-sender-id="AI_è§ç‚_æ–—ç ´è‹ç©¹"] .message-sender { color: var(--dq-xiaoyan-accent-fire-dark); }
.details-panel.AI_è§ç‚_æ–—ç ´è‹ç©¹ #detailsName { color: var(--dq-xiaoyan-accent-fire-dark); }
.details-panel.AI_è§ç‚_æ–—ç ´è‹ç©¹ .details-avatar.AI_è§ç‚_æ–—ç ´è‹ç©¹ {
    border-image: linear-gradient(60deg, var(--dq-xiaoyan-accent-gold-dark), var(--dq-xiaoyan-accent-cyan-dark), var(--dq-xiaoyan-accent-fire-dark)) 1;
    animation-name: dq-dark-xiaoyan-glow; filter: brightness(1.1);
}
@keyframes dq-dark-xiaoyan-glow {
    0% { filter: saturate(1.2) brightness(1.1); }
    50% { filter: saturate(1.5) brightness(1.3); }
    100% { filter: saturate(1.2) brightness(1.1); }
}
.details-panel.AI_è§ç‚_æ–—ç ´è‹ç©¹ #aiContactAboutSection h4 span { color: var(--dq-xiaoyan-accent-cyan-dark); }


/* ğŸ“œ è¯è€ - é“¶ç™½ã€æ·¡ç´«ã€çµé­‚è“ ğŸ“œ */
.chat-list-item.special-contact.AI_è¯è€_æ–—ç ´è‹ç©¹ .chat-list-avatar,
.chat-avatar-main.AI_è¯è€_æ–—ç ´è‹ç©¹, .details-avatar.AI_è¯è€_æ–—ç ´è‹ç©¹, #callingModalAvatar.AI_è¯è€_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-yaolao-primary-dark);
    color: var(--dq-yaolao-accent-purple-dark);
    border-color: var(--dq-yaolao-accent-soulblue-dark);
    box-shadow: 0 0 9px var(--dq-yaolao-accent-soulblue-dark), 0 0 6px rgba(var(--dq-yaolao-accent-purple-dark-rgb),0.6) inset;
    text-shadow: 0 0 3px var(--dq-yaolao-accent-purple-dark);
}
.chat-list-item.active.AI_è¯è€_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-yaolao-secondary-dark);
    box-shadow: inset 3px 0 0 0 var(--dq-yaolao-accent-purple-dark),
    0 0 12px rgba(var(--dq-yaolao-accent-soulblue-dark-rgb), 0.3) inset;
}
.chat-list-item.active.AI_è¯è€_æ–—ç ´è‹ç©¹ .chat-list-name { color: var(--dq-yaolao-accent-purple-dark); }
.chat-header-main.current-chat-AI_è¯è€_æ–—ç ´è‹ç©¹ .chat-title-main { color: var(--dq-yaolao-accent-soulblue-dark); }
.message.received[data-sender-id="AI_è¯è€_æ–—ç ´è‹ç©¹"] {
    border-right-color: var(--dq-yaolao-accent-soulblue-dark);
    background-color: rgba(var(--dq-yaolao-accent-purple-dark-rgb), 0.1);
}
.message.received[data-sender-id="AI_è¯è€_æ–—ç ´è‹ç©¹"] .message-sender { color: var(--dq-yaolao-accent-purple-dark); }
.details-panel.AI_è¯è€_æ–—ç ´è‹ç©¹ #detailsName { color: var(--dq-yaolao-accent-purple-dark); }
.details-panel.AI_è¯è€_æ–—ç ´è‹ç©¹ .details-avatar.AI_è¯è€_æ–—ç ´è‹ç©¹ {
    border-image: linear-gradient(60deg, var(--dq-yaolao-accent-soulblue-dark), var(--dq-yaolao-accent-purple-dark), var(--dq-dark-obsidian-panel)) 1;
    filter: brightness(1.2);
}
.details-panel.AI_è¯è€_æ–—ç ´è‹ç©¹ #aiContactAboutSection h4 span { color: var(--dq-yaolao-accent-soulblue-dark); }


/* ğŸ ç¾æœèå¥³ç‹ - å¦–ç´«ã€ç«çº¢ã€æš—é‡‘ ğŸ */
.chat-list-item.special-contact.AI_ç¾æœè_æ–—ç ´è‹ç©¹ .chat-list-avatar,
.chat-avatar-main.AI_ç¾æœè_æ–—ç ´è‹ç©¹, .details-avatar.AI_ç¾æœè_æ–—ç ´è‹ç©¹, #callingModalAvatar.AI_ç¾æœè_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-medusa-primary-dark);
    color: var(--dq-medusa-accent-darkgold-dark);
    border-color: var(--dq-medusa-accent-rose-dark);
    text-shadow: 0 0 5px var(--dq-medusa-accent-darkgold-dark);
    box-shadow: 0 0 8px var(--dq-medusa-accent-rose-dark);
}
.chat-list-item.active.AI_ç¾æœè_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-medusa-secondary-dark);
    box-shadow: inset 3px 0 0 0 var(--dq-medusa-accent-rose-dark),
    0 0 12px rgba(var(--dq-medusa-primary-dark-rgb),0.4) inset;
}
.chat-list-item.active.AI_ç¾æœè_æ–—ç ´è‹ç©¹ .chat-list-name { color: var(--dq-medusa-primary-dark); }
.chat-header-main.current-chat-AI_ç¾æœè_æ–—ç ´è‹ç©¹ .chat-title-main { color: var(--dq-medusa-primary-dark); text-shadow: 0 0 6px var(--dq-medusa-accent-rose-dark); }
.message.received[data-sender-id="AI_ç¾æœè_æ–—ç ´è‹ç©¹"] {
    border-right-color: var(--dq-medusa-primary-dark);
    background-color: rgba(var(--dq-medusa-primary-dark-rgb),0.12);
}
.message.received[data-sender-id="AI_ç¾æœè_æ–—ç ´è‹ç©¹"] .message-sender { color: var(--dq-medusa-accent-rose-dark); }
.details-panel.AI_ç¾æœè_æ–—ç ´è‹ç©¹ #detailsName { color: var(--dq-medusa-primary-dark); }
.details-panel.AI_ç¾æœè_æ–—ç ´è‹ç©¹ .details-avatar.AI_ç¾æœè_æ–—ç ´è‹ç©¹ {
    border-image: linear-gradient(60deg, var(--dq-medusa-accent-darkgold-dark), var(--dq-medusa-accent-rose-dark), var(--dq-medusa-primary-dark)) 1;
    animation-name: dq-dark-medusa-glow;
}
@keyframes dq-dark-medusa-glow {
    from { filter: brightness(1.1) saturate(1.1); }
    to { filter: brightness(1.3) saturate(1.3); }
}
.details-panel.AI_ç¾æœè_æ–—ç ´è‹ç©¹ #aiContactAboutSection h4 span, .details-panel.AI_ç¾æœè_æ–—ç ´è‹ç©¹ #detailsName { color: var(--dq-medusa-primary-dark); }


/* â˜ï¸ äº‘éŸµ - å¤©è“ã€æ·¡é‡‘ â˜ï¸ */
.chat-list-item.special-contact.AI_äº‘éŸµ_æ–—ç ´è‹ç©¹ .chat-list-avatar,
.chat-avatar-main.AI_äº‘éŸµ_æ–—ç ´è‹ç©¹, .details-avatar.AI_äº‘éŸµ_æ–—ç ´è‹ç©¹, #callingModalAvatar.AI_äº‘éŸµ_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-yunyun-primary-dark);
    color: var(--dq-dark-text-ash-white);
    border-color: var(--dq-yunyun-accent-gold-dark);
    box-shadow: 0 0 7px var(--dq-yunyun-accent-gold-dark);
}
.chat-list-item.active.AI_äº‘éŸµ_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-yunyun-secondary-dark);
    box-shadow: inset 3px 0 0 0 var(--dq-yunyun-accent-gold-dark),
    0 0 10px rgba(var(--dq-yunyun-primary-dark-rgb),0.3) inset;
}
.chat-list-item.active.AI_äº‘éŸµ_æ–—ç ´è‹ç©¹ .chat-list-name { color: var(--dq-yunyun-primary-dark); }
.chat-header-main.current-chat-AI_äº‘éŸµ_æ–—ç ´è‹ç©¹ .chat-title-main { color: var(--dq-yunyun-primary-dark); text-shadow: 0 0 5px var(--dq-yunyun-accent-gold-dark); }
.message.received[data-sender-id="AI_äº‘éŸµ_æ–—ç ´è‹ç©¹"] {
    border-right-color: var(--dq-yunyun-primary-dark);
    background-color: rgba(var(--dq-yunyun-primary-dark-rgb),0.1);
}
.message.received[data-sender-id="AI_äº‘éŸµ_æ–—ç ´è‹ç©¹"] .message-sender { color: var(--dq-yunyun-primary-dark); }
.details-panel.AI_äº‘éŸµ_æ–—ç ´è‹ç©¹ #detailsName { color: var(--dq-yunyun-primary-dark); }
.details-panel.AI_äº‘éŸµ_æ–—ç ´è‹ç©¹ .details-avatar.AI_äº‘éŸµ_æ–—ç ´è‹ç©¹ {
    border-image: linear-gradient(60deg, var(--dq-yunyun-accent-gold-dark), var(--dq-yunyun-primary-dark)) 1;
}
.details-panel.AI_äº‘éŸµ_æ–—ç ´è‹ç©¹ #aiContactAboutSection h4 span { color: var(--dq-yunyun-accent-gold-dark); }


/* ğŸŒ¸ çº³å…°å«£ç„¶ - æµ…ç´«ã€ç«çº¢ ğŸŒ¸ */
.chat-list-item.special-contact.AI_çº³å…°å«£ç„¶_æ–—ç ´è‹ç©¹ .chat-list-avatar,
.chat-avatar-main.AI_çº³å…°å«£ç„¶_æ–—ç ´è‹ç©¹, .details-avatar.AI_çº³å…°å«£ç„¶_æ–—ç ´è‹ç©¹, #callingModalAvatar.AI_çº³å…°å«£ç„¶_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-nalan-primary-dark);
    color: var(--dq-dark-text-ash-white);
    border-color: var(--dq-nalan-accent-rose-dark);
    box-shadow: 0 0 7px var(--dq-nalan-accent-rose-dark);
}
.chat-list-item.active.AI_çº³å…°å«£ç„¶_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-nalan-secondary-dark);
    box-shadow: inset 3px 0 0 0 var(--dq-nalan-accent-rose-dark),
    0 0 10px rgba(var(--dq-nalan-primary-dark-rgb),0.3) inset;
}
.chat-list-item.active.AI_çº³å…°å«£ç„¶_æ–—ç ´è‹ç©¹ .chat-list-name { color: var(--dq-nalan-primary-dark); }
.chat-header-main.current-chat-AI_çº³å…°å«£ç„¶_æ–—ç ´è‹ç©¹ .chat-title-main { color: var(--dq-nalan-primary-dark); text-shadow: 0 0 5px var(--dq-nalan-accent-rose-dark); }
.message.received[data-sender-id="AI_çº³å…°å«£ç„¶_æ–—ç ´è‹ç©¹"] {
    border-right-color: var(--dq-nalan-primary-dark);
    background-color: rgba(var(--dq-nalan-primary-dark-rgb),0.1);
}
.message.received[data-sender-id="AI_çº³å…°å«£ç„¶_æ–—ç ´è‹ç©¹"] .message-sender { color: var(--dq-nalan-accent-rose-dark); }
.details-panel.AI_çº³å…°å«£ç„¶_æ–—ç ´è‹ç©¹ #detailsName { color: var(--dq-nalan-primary-dark); }
.details-panel.AI_çº³å…°å«£ç„¶_æ–—ç ´è‹ç©¹ .details-avatar.AI_çº³å…°å«£ç„¶_æ–—ç ´è‹ç©¹ {
    border-image: linear-gradient(60deg, var(--dq-nalan-accent-rose-dark), var(--dq-nalan-primary-dark)) 1;
}
.details-panel.AI_çº³å…°å«£ç„¶_æ–—ç ´è‹ç©¹ #aiContactAboutSection h4 span { color: var(--dq-nalan-accent-rose-dark); }


/* ğŸ”¥ è§è–°å„¿ - é‡‘é»„ã€èµ¤ç„° ğŸ”¥ */
.chat-list-item.special-contact.AI_è§è–°å„¿_æ–—ç ´è‹ç©¹ .chat-list-avatar,
.chat-avatar-main.AI_è§è–°å„¿_æ–—ç ´è‹ç©¹, .details-avatar.AI_è§è–°å„¿_æ–—ç ´è‹ç©¹, #callingModalAvatar.AI_è§è–°å„¿_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-xuner-primary-dark);
    color: var(--dq-dark-nightsky-black);
    border-color: var(--dq-xuner-accent-flame-dark);
    text-shadow: 0 0 3px rgba(var(--dq-dark-nightsky-black-rgb),0.7);
    box-shadow: 0 0 8px var(--dq-xuner-accent-flame-dark);
}
.chat-list-item.active.AI_è§è–°å„¿_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-xuner-secondary-dark);
    box-shadow: inset 3px 0 0 0 var(--dq-xuner-accent-flame-dark),
    0 0 12px rgba(var(--dq-xuner-primary-dark-rgb),0.4) inset;
}
.chat-list-item.active.AI_è§è–°å„¿_æ–—ç ´è‹ç©¹ .chat-list-name { color: var(--dq-xuner-primary-dark); }
.chat-header-main.current-chat-AI_è§è–°å„¿_æ–—ç ´è‹ç©¹ .chat-title-main { color: var(--dq-xuner-primary-dark); text-shadow: 0 0 6px var(--dq-xuner-accent-flame-dark); }
.message.received[data-sender-id="AI_è§è–°å„¿_æ–—ç ´è‹ç©¹"] {
    border-right-color: var(--dq-xuner-primary-dark);
    background-color: rgba(var(--dq-xuner-primary-dark-rgb),0.12);
}
.message.received[data-sender-id="AI_è§è–°å„¿_æ–—ç ´è‹ç©¹"] .message-sender { color: var(--dq-xuner-accent-flame-dark); }
.details-panel.AI_è§è–°å„¿_æ–—ç ´è‹ç©¹ #detailsName { color: var(--dq-xuner-primary-dark); }
.details-panel.AI_è§è–°å„¿_æ–—ç ´è‹ç©¹ .details-avatar.AI_è§è–°å„¿_æ–—ç ´è‹ç©¹ {
    border-image: linear-gradient(60deg, var(--dq-xuner-accent-flame-dark), var(--dq-xuner-primary-dark)) 1;
}
.details-panel.AI_è§è–°å„¿_æ–—ç ´è‹ç©¹ #aiContactAboutSection h4 span { color: var(--dq-xuner-accent-flame-dark); }


/* ğŸ’€ é­‚æ®¿ - æ·±ç´«ã€é»‘ç„° ğŸ’€ */
.chat-list-item.special-contact.AI_é­‚æ®¿_æ–—ç ´è‹ç©¹ .chat-list-avatar,
.chat-avatar-main.AI_é­‚æ®¿_æ–—ç ´è‹ç©¹, .details-avatar.AI_é­‚æ®¿_æ–—ç ´è‹ç©¹, #callingModalAvatar.AI_é­‚æ®¿_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-soulhall-primary-dark);
    color: var(--dq-dark-text-shadow-gray);
    border-color: var(--dq-soulhall-accent-blackflame-dark);
    text-shadow: 0 0 4px var(--dq-dark-text-shadow-gray);
    box-shadow: 0 0 8px var(--dq-soulhall-accent-blackflame-dark), 0 0 5px var(--dq-soulhall-primary-dark) inset;
}
.chat-list-item.active.AI_é­‚æ®¿_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-soulhall-secondary-dark);
    box-shadow: inset 3px 0 0 0 var(--dq-soulhall-accent-blackflame-dark),
    0 0 12px rgba(var(--dq-soulhall-primary-dark-rgb),0.4) inset;
}
.chat-list-item.active.AI_é­‚æ®¿_æ–—ç ´è‹ç©¹ .chat-list-name { color: var(--dq-soulhall-primary-dark); }
.chat-header-main.current-chat-AI_é­‚æ®¿_æ–—ç ´è‹ç©¹ .chat-title-main { color: var(--dq-soulhall-primary-dark); text-shadow: 0 0 6px var(--dq-soulhall-accent-blackflame-dark); }
.message.received[data-sender-id="AI_é­‚æ®¿_æ–—ç ´è‹ç©¹"] {
    border-right-color: var(--dq-soulhall-primary-dark);
    background-color: rgba(var(--dq-soulhall-accent-blackflame-dark-rgb),0.25);
}
.message.received[data-sender-id="AI_é­‚æ®¿_æ–—ç ´è‹ç©¹"] .message-sender { color: var(--dq-soulhall-accent-blackflame-dark); }
.details-panel.AI_é­‚æ®¿_æ–—ç ´è‹ç©¹ #detailsName { color: var(--dq-soulhall-primary-dark); }
.details-panel.AI_é­‚æ®¿_æ–—ç ´è‹ç©¹ .details-avatar.AI_é­‚æ®¿_æ–—ç ´è‹ç©¹ {
    border-image: linear-gradient(60deg, var(--dq-soulhall-accent-blackflame-dark), var(--dq-soulhall-primary-dark)) 1;
    filter: contrast(1.2);
}
.details-panel.AI_é­‚æ®¿_æ–—ç ´è‹ç©¹ #aiContactAboutSection h4 span { color: var(--dq-soulhall-accent-blackflame-dark); }


/* ğŸ–¤ éŸ©æ« - æš—çº¢ã€ç°é»‘ ğŸ–¤ */
.chat-list-item.special-contact.AI_éŸ©æ«_æ–—ç ´è‹ç©¹ .chat-list-avatar,
.chat-avatar-main.AI_éŸ©æ«_æ–—ç ´è‹ç©¹, .details-avatar.AI_éŸ©æ«_æ–—ç ´è‹ç©¹, #callingModalAvatar.AI_éŸ©æ«_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-hanfeng-accent-grayblack-dark);
    color: var(--dq-hanfeng-primary-dark);
    border-color: var(--dq-hanfeng-primary-dark);
    text-shadow: 0 0 3px var(--dq-hanfeng-primary-dark);
    box-shadow: 0 0 7px var(--dq-hanfeng-primary-dark);
}
.chat-list-item.active.AI_éŸ©æ«_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-hanfeng-secondary-dark);
    box-shadow: inset 3px 0 0 0 var(--dq-hanfeng-primary-dark),
    0 0 10px rgba(var(--dq-hanfeng-accent-grayblack-dark-rgb),0.4) inset;
}
.chat-list-item.active.AI_éŸ©æ«_æ–—ç ´è‹ç©¹ .chat-list-name { color: var(--dq-hanfeng-primary-dark); }
.chat-header-main.current-chat-AI_éŸ©æ«_æ–—ç ´è‹ç©¹ .chat-title-main { color: var(--dq-hanfeng-primary-dark); text-shadow: 0 0 5px var(--dq-hanfeng-accent-grayblack-dark); }
.message.received[data-sender-id="AI_éŸ©æ«_æ–—ç ´è‹ç©¹"] {
    border-right-color: var(--dq-hanfeng-primary-dark);
    background-color: rgba(var(--dq-hanfeng-accent-grayblack-dark-rgb),0.15);
}
.message.received[data-sender-id="AI_éŸ©æ«_æ–—ç ´è‹ç©¹"] .message-sender { color: var(--dq-hanfeng-accent-grayblack-dark); }
.details-panel.AI_éŸ©æ«_æ–—ç ´è‹ç©¹ #detailsName { color: var(--dq-hanfeng-primary-dark); }
.details-panel.AI_éŸ©æ«_æ–—ç ´è‹ç©¹ .details-avatar.AI_éŸ©æ«_æ–—ç ´è‹ç©¹ {
    border-image: linear-gradient(60deg, var(--dq-hanfeng-primary-dark), var(--dq-hanfeng-accent-grayblack-dark)) 1;
}
.details-panel.AI_éŸ©æ«_æ–—ç ´è‹ç©¹ #aiContactAboutSection h4 span { color: var(--dq-hanfeng-accent-grayblack-dark); }


/* ğŸŒ¿ æ—ä¿®å´– - é’ç°ã€é“ç»¿ ğŸŒ¿ */
.chat-list-item.special-contact.AI_æ—ä¿®å´–_æ–—ç ´è‹ç©¹ .chat-list-avatar,
.chat-avatar-main.AI_æ—ä¿®å´–_æ–—ç ´è‹ç©¹, .details-avatar.AI_æ—ä¿®å´–_æ–—ç ´è‹ç©¹, #callingModalAvatar.AI_æ—ä¿®å´–_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-linxiuya-primary-dark);
    color: var(--dq-linxiuya-accent-irongreen-dark);
    border-color: var(--dq-linxiuya-accent-irongreen-dark);
    box-shadow: 0 0 6px var(--dq-linxiuya-accent-irongreen-dark);
}
.chat-list-item.active.AI_æ—ä¿®å´–_æ–—ç ´è‹ç©¹ {
    background-color: var(--dq-linxiuya-secondary-dark);
    box-shadow: inset 3px 0 0 0 var(--dq-linxiuya-accent-irongreen-dark),
    0 0 10px rgba(var(--dq-linxiuya-primary-dark-rgb),0.25) inset;
}
.chat-list-item.active.AI_æ—ä¿®å´–_æ–—ç ´è‹ç©¹ .chat-list-name { color: var(--dq-linxiuya-accent-irongreen-dark); }
.chat-header-main.current-chat-AI_æ—ä¿®å´–_æ–—ç ´è‹ç©¹ .chat-title-main { color: var(--dq-linxiuya-accent-irongreen-dark); }
.message.received[data-sender-id="AI_æ—ä¿®å´–_æ–—ç ´è‹ç©¹"] {
    border-right-color: var(--dq-linxiuya-primary-dark);
    background-color: rgba(var(--dq-linxiuya-primary-dark-rgb),0.1);
}
.message.received[data-sender-id="AI_æ—ä¿®å´–_æ–—ç ´è‹ç©¹"] .message-sender { color: var(--dq-linxiuya-primary-dark); }
.details-panel.AI_æ—ä¿®å´–_æ–—ç ´è‹ç©¹ #detailsName { color: var(--dq-linxiuya-accent-irongreen-dark); }
.details-panel.AI_æ—ä¿®å´–_æ–—ç ´è‹ç©¹ .details-avatar.AI_æ—ä¿®å´–_æ–—ç ´è‹ç©¹ {
    border-image: linear-gradient(60deg, var(--dq-linxiuya-accent-irongreen-dark), var(--dq-linxiuya-primary-dark)) 1;
}
.details-panel.AI_æ—ä¿®å´–_æ–—ç ´è‹ç©¹ #aiContactAboutSection h4 span { color: var(--dq-linxiuya-primary-dark); }


/* ä¿ç•™å…¶ä»–è§’è‰² (å°åŒ»ä»™, æµ·æ³¢ä¸œ, ç´«å¦) - ä»åŸCSSç»§æ‰¿ï¼Œå¯æŒ‰éœ€é€‚é…æ–°ä¸»é¢˜ */
/* å°åŒ»ä»™ */
.chat-list-item.special-contact.AI_å°åŒ»ä»™_æ–—ç ´è‹ç©¹ .chat-list-avatar,
.chat-avatar-main.AI_å°åŒ»ä»™_æ–—ç ´è‹ç©¹, .details-avatar.AI_å°åŒ»ä»™_æ–—ç ´è‹ç©¹, #callingModalAvatar.AI_å°åŒ»ä»™_æ–—ç ´è‹ç©¹ {
    background-color: var(--btth-xiaoyixian-primary-dark); color: var(--dq-dark-text-ash-white); border-color: rgba(var(--dq-dark-text-ash-white-rgb), 0.5);
}
.chat-list-item.active.AI_å°åŒ»ä»™_æ–—ç ´è‹ç©¹ { background-color: var(--btth-xiaoyixian-secondary-dark); box-shadow: 0 0 8px var(--btth-xiaoyixian-primary-dark) inset; }
.chat-list-item.active.AI_å°åŒ»ä»™_æ–—ç ´è‹ç©¹ .chat-list-name { color: var(--btth-xiaoyixian-primary-dark); }
.chat-header-main.current-chat-AI_å°åŒ»ä»™_æ–—ç ´è‹ç©¹ .chat-title-main { color: var(--btth-xiaoyixian-primary-dark); }
.message.received[data-sender-id="AI_å°åŒ»ä»™_æ–—ç ´è‹ç©¹"] { border-right: 2px solid var(--btth-xiaoyixian-primary-dark); background-color: rgba(110, 110, 120, 0.1); }
.message.received[data-sender-id="AI_å°åŒ»ä»™_æ–—ç ´è‹ç©¹"] .message-sender { color: var(--btth-xiaoyixian-primary-dark); }
.details-panel.AI_å°åŒ»ä»™_æ–—ç ´è‹ç©¹ #aiContactAboutSection h4 span, .details-panel.AI_å°åŒ»ä»™_æ–—ç ´è‹ç©¹ #detailsName { color: var(--btth-xiaoyixian-primary-dark); }

/* æµ·æ³¢ä¸œ */
.chat-list-item.special-contact.AI_æµ·æ³¢ä¸œ_æ–—ç ´è‹ç©¹ .chat-list-avatar,
.chat-avatar-main.AI_æµ·æ³¢ä¸œ_æ–—ç ´è‹ç©¹, .details-avatar.AI_æµ·æ³¢ä¸œ_æ–—ç ´è‹ç©¹, #callingModalAvatar.AI_æµ·æ³¢ä¸œ_æ–—ç ´è‹ç©¹ {
    background-color: var(--btth-haibodong-primary-dark); color: var(--dq-dark-nightsky-black); border-color: var(--dq-dark-nightsky-black);
}
.chat-list-item.active.AI_æµ·æ³¢ä¸œ_æ–—ç ´è‹ç©¹ { background-color: var(--btth-haibodong-secondary-dark); box-shadow: 0 0 8px var(--btth-haibodong-primary-dark) inset; }
.chat-list-item.active.AI_æµ·æ³¢ä¸œ_æ–—ç ´è‹ç©¹ .chat-list-name { color: var(--btth-haibodong-primary-dark); }
.chat-header-main.current-chat-AI_æµ·æ³¢ä¸œ_æ–—ç ´è‹ç©¹ .chat-title-main { color: var(--btth-haibodong-primary-dark); }
.message.received[data-sender-id="AI_æµ·æ³¢ä¸œ_æ–—ç ´è‹ç©¹"] { border-right: 2px solid var(--btth-haibodong-primary-dark); background-color: rgba(100, 170, 220, 0.1); }
.message.received[data-sender-id="AI_æµ·æ³¢ä¸œ_æ–—ç ´è‹ç©¹"] .message-sender { color: var(--btth-haibodong-primary-dark); }
.details-panel.AI_æµ·æ³¢ä¸œ_æ–—ç ´è‹ç©¹ #aiContactAboutSection h4 span, .details-panel.AI_æµ·æ³¢ä¸œ_æ–—ç ´è‹ç©¹ #detailsName { color: var(--btth-haibodong-primary-dark); }

/* ç´«å¦ */
.chat-list-item.special-contact.AI_ç´«å¦_æ–—ç ´è‹ç©¹ .chat-list-avatar,
.chat-avatar-main.AI_ç´«å¦_æ–—ç ´è‹ç©¹, .details-avatar.AI_ç´«å¦_æ–—ç ´è‹ç©¹, #callingModalAvatar.AI_ç´«å¦_æ–—ç ´è‹ç©¹ {
    background-color: var(--btth-ziyan-primary-dark); color: var(--dq-dark-text-ash-white); border-color: var(--dq-dark-text-ash-white);
}
.chat-list-item.active.AI_ç´«å¦_æ–—ç ´è‹ç©¹ { background-color: var(--btth-ziyan-secondary-dark); box-shadow: 0 0 8px var(--btth-ziyan-primary-dark) inset; }
.chat-list-item.active.AI_ç´«å¦_æ–—ç ´è‹ç©¹ .chat-list-name { color: var(--btth-ziyan-primary-dark); }
.chat-header-main.current-chat-AI_ç´«å¦_æ–—ç ´è‹ç©¹ .chat-title-main { color: var(--btth-ziyan-primary-dark); }
.message.received[data-sender-id="AI_ç´«å¦_æ–—ç ´è‹ç©¹"] { border-right: 2px solid var(--btth-ziyan-primary-dark); background-color: rgba(160, 90, 200, 0.1); }
.message.received[data-sender-id="AI_ç´«å¦_æ–—ç ´è‹ç©¹"] .message-sender { color: var(--btth-ziyan-primary-dark); }
.details-panel.AI_ç´«å¦_æ–—ç ´è‹ç©¹ #aiContactAboutSection h4 span, .details-panel.AI_ç´«å¦_æ–—ç ´è‹ç©¹ #detailsName { color: var(--btth-ziyan-primary-dark); }


/* --- é€šç”¨æŒ‰é’®æ ·å¼ (é­”ç„°/é­‚çº¹ç‰¹æ•ˆ) --- */
.btn {
    border-radius: var(--border-radius);
    text-transform: none;
    letter-spacing: 0.5px;
    font-weight: 600;
    box-shadow: 0 1px 3px rgba(0,0,0,0.6),
    inset 0 -2px 0px rgba(0,0,0,0.3); /* Deeper 3D effect */
    border: 1px solid transparent;
    transition: all 0.2s ease-in-out;
    padding: 8px 18px;
    position: relative;
    overflow: hidden;
}
.btn::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: transparent;
    border-radius: var(--border-radius);
    transition: background 0.3s ease;
    z-index: 0;
}
.btn > * { position: relative; z-index: 1; }

/* ä¸»æŒ‰é’® - ç‡ƒçƒ§å¼‚ç«çº¹ç† */
.btn-primary {
    background-color: var(--primary-color);
    color: var(--text-color-inverted);
    border-color: var(--primary-color-dark);
}
.btn-primary:hover {
    background-color: var(--primary-color-dark);
    color: var(--text-color-inverted);
    box-shadow: 0 3px 8px rgba(var(--dq-dark-heavenly-flame-red-rgb),0.4),
    inset 0 -1px 0px rgba(0,0,0,0.4),
    0 0 15px rgba(var(--dq-dark-soul-purple-rgb),0.3); /* å¼‚ç«ä¸é­‚åŠ›äº¤ç»‡ */
    transform: translateY(-1px) scale(1.02);
}
.btn-primary:active::before {
    background: rgba(var(--dq-dark-nightsky-black-rgb), 0.2);
}

/* æ¬¡æŒ‰é’® - é»‘æ›œçŸ³é­‚çº¹ */
.btn-secondary {
    background-color: var(--dq-dark-volcanic-border);
    color: var(--dq-dark-text-ash-white);
    border-color: rgba(var(--dq-dark-text-ash-white-rgb),0.15);
}
.btn-secondary:hover {
    background-color: rgb(60, 58, 65);
    box-shadow: 0 3px 8px rgba(var(--dq-dark-volcanic-border-rgb),0.4),
    inset 0 -1px 0px rgba(0,0,0,0.4),
    0 0 12px rgba(var(--dq-dark-soul-purple-rgb),0.2); /* é­‚çº¹å¾®å…‰ */
    transform: translateY(-1px);
}
.btn-secondary:active::before {
    background: rgba(var(--dq-dark-text-ash-white-rgb), 0.08);
}

.btn-danger {
    background-color: var(--dq-dark-danger-crimson);
    color: var(--dq-dark-text-ash-white);
    border-color: rgba(150, 20, 30, 0.8);
}
.btn-danger:hover {
    background-color: rgb(150, 20, 30);
    box-shadow: 0 3px 8px rgba(var(--dq-dark-danger-crimson-rgb),0.4),
    inset 0 -1px 0px rgba(0,0,0,0.4);
    transform: translateY(-1px);
}
.btn-success {
    background-color: var(--primary-color); /* Typically success is green, but theme uses flame */
    color: var(--text-color-inverted);
    border-color: var(--primary-color-dark);
}
.btn-success:hover {
    background-color: var(--primary-color-dark);
}


/* --- Modals (é­‚åŸŸè£‚ç¼æˆ–é­”æ™¶å‡ç»“) --- */
.loading-overlay { background-color: rgba(var(--dq-dark-nightsky-black-rgb), 0.92); backdrop-filter: blur(4px); }
.loading-spinner {
    width: 60px;
    height: 60px;
    border-width: 5px;
    border-top-color: var(--primary-color);
    border-left-color: var(--primary-color);
    border-bottom-color: rgba(var(--dq-dark-heavenly-flame-red-rgb),0.25);
    border-right-color: rgba(var(--dq-dark-heavenly-flame-red-rgb),0.25);
    animation: spin 1s linear infinite, dq-dark-spinner-color-shift 3s linear infinite alternate;
}
@keyframes dq-dark-spinner-color-shift {
    0% { border-top-color: var(--primary-color); border-left-color: var(--primary-color); }
    50% { border-top-color: var(--dq-dark-soul-purple); border-left-color: var(--dq-dark-soul-purple); }
    100% { border-top-color: var(--dq-dark-demonic-cyan-flame); border-left-color: var(--dq-dark-demonic-cyan-flame); }
}

.modal-content {
    background-color: var(--secondary-color);
    border: 1px solid var(--border-color);
    box-shadow: 0 8px 30px rgba(0,0,0,0.5),
    0 0 0 2px rgba(var(--primary-color-rgb),0.25); /* é­”æ™¶å¤–æ¡† */
    border-radius: var(--border-radius);
}
.modal-header h2 {
    color: var(--primary-color);
    text-shadow: 0 0 8px rgba(var(--primary-color-rgb),0.4),
    0 0 12px rgba(var(--dq-dark-soul-purple-rgb),0.3);
}
.close-modal-btn:hover { color: var(--primary-color); }
.modal-body input[type="text"], .modal-body textarea {
    background-color: rgba(var(--dq-dark-nightsky-black-rgb), 0.88);
    color: var(--text-color);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    padding: 10px;
}
.modal-body input[type="text"]:focus, .modal-body textarea:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 1.5px rgba(var(--primary-color-rgb),0.4);
}
.user-id-display #modalUserIdValue {
    background: rgba(var(--dq-dark-nightsky-black-rgb),0.85);
    color: var(--primary-color);
    border: 1px dashed var(--primary-color);
    padding: 8px 12px;
    border-radius: var(--border-radius);
    font-weight: 500;
}

/* Video Call */
.video-call-avatar { background-color: var(--dq-dark-volcanic-border); border: 1px solid var(--border-color); }
.video-call-button.end-call { background: var(--danger-color); }
.video-call-button.active { background: var(--primary-color); color: var(--text-color-inverted); }

/* Toggle Switch */
.slider { background-color: var(--dq-dark-volcanic-border); }
.slider:before { background-color: var(--dq-dark-obsidian-panel); box-shadow: 0 1px 2px rgba(0,0,0,0.4); }
input:checked + .slider { background-color: var(--primary-color); }
input:checked + .slider:before { transform: translateX(20px); }


/* --- ç¡®ä¿ç‰¹å®šéšè—/æ˜¾ç¤ºéƒ¨åˆ† --- */
#detailsPanelContent #aiContactAboutSection,
#detailsPanelContent #detailsGroupManagement #addGroupMemberArea,
#detailsPanelContent #detailsGroupManagement #leftMembersArea,
#detailsPanelContent #groupActionsDetails,
#detailsPanelContent #dissolveGroupBtnDetails,
#mainMenuModal .settings-section.manual-connection-advanced,
#mainMenuModal #modalResetAllConnectionsBtn {
    display: none;
}

/* ç‰¹å®šäºAIè§’è‰²æ˜¾ç¤º"å…³äº"åŒºåŸŸçš„æ ·å¼ */
.details-panel.AI_è§ç‚_æ–—ç ´è‹ç©¹ #aiContactAboutSection,
.details-panel.AI_è¯è€_æ–—ç ´è‹ç©¹ #aiContactAboutSection,
.details-panel.AI_è§è–°å„¿_æ–—ç ´è‹ç©¹ #aiContactAboutSection,
.details-panel.AI_ç¾æœè_æ–—ç ´è‹ç©¹ #aiContactAboutSection,
.details-panel.AI_å°åŒ»ä»™_æ–—ç ´è‹ç©¹ #aiContactAboutSection,
.details-panel.AI_äº‘éŸµ_æ–—ç ´è‹ç©¹ #aiContactAboutSection,
.details-panel.AI_æµ·æ³¢ä¸œ_æ–—ç ´è‹ç©¹ #aiContactAboutSection,
.details-panel.AI_ç´«å¦_æ–—ç ´è‹ç©¹ #aiContactAboutSection,
.details-panel.AI_çº³å…°å«£ç„¶_æ–—ç ´è‹ç©¹ #aiContactAboutSection,
.details-panel.AI_é­‚æ®¿_æ–—ç ´è‹ç©¹ #aiContactAboutSection,
.details-panel.AI_éŸ©æ«_æ–—ç ´è‹ç©¹ #aiContactAboutSection,
.details-panel.AI_æ—ä¿®å´–_æ–—ç ´è‹ç©¹ #aiContactAboutSection {
    display: block;
}

.details-panel.human-contact-active #contactActionsDetails { display: block; }
.details-panel.group-chat-active #detailsGroupManagement,
.details-panel.group-chat-active #groupActionsDetails { display: block; }

.notification {
    background: var(--dq-dark-obsidian-panel);
    border-left: 4px solid var(--primary-color);
    color: var(--text-color);
    box-shadow: 0 3px 10px rgba(0,0,0,0.4);
    border-radius: var(--border-radius);
    padding: 12px 18px;
}
.notification.error {
    border-left-color: var(--danger-color);
}
.notification.success {
    border-left-color: var(--dq-dark-ancient-gold);
}
#ttsConfigFormContainer .tts-config-item * {
    color: #ccc;
}